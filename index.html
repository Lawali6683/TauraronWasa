<!DOCTYPE html>
<html lang="ha">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TauraronWasa </title>
  <meta property="og:description" content="TauraronWasa shine gidan nisha…ói da wasanni na zamani! Ku kalli wasannin kwallon kafa kai tsaye, ku saurari rediyo da bidiyo, ku karanta labarai da hira da ‚Äôyan wasa, ku yi sharhi da comments, ku bibiye tarihin wasanni, har ma ku shiga kasuwar saye da sayarwa na ‚Äôyan wasa. Duk abin nisha…ói da wasan ku, akwai a TauraronWasa!" />
<meta property="og:image" content="https://i.imgur.com/CgvdgMA.png" />
<meta property="og:image:secure_url" content="https://i.imgur.com/CgvdgMA.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://tauraronwasa.pages.dev/" />
<meta property="og:image:alt" content="TauraronWasa Labaran Wasanni" />
<link rel="icon" type="image/png" href="https://i.imgur.com/CgvdgMA.png" />
<link rel="manifest" href="/manifest.json">
    
    <!-- Poppins font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- FontAwesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
   body {
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to bottom, #180022, #300040);
    background-repeat: no-repeat;
    background-attachment: fixed; 
    background-size: cover;
    color: #ffffff;    
    transition: background 0.6s, color 0.6s;
}

body.bg-1 {
    background: linear-gradient(to bottom, #180022, #300040);
    background-attachment: fixed;
    color: #ffffff;
}

body.bg-2 {
    background: linear-gradient(to bottom right, #ffffff, #f0f0f0);
    background-attachment: fixed;
    color: #222222;
}

body.bg-3 {
    background: #0e0e0e;
    background-attachment: fixed;
    color: #f4f4f4;
}

header#site1-header {
    width: 100%;
    background: none;
    padding: 0.6rem 1.2rem 0.6rem 0.6rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    z-index: 10;
}

.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    
}
.logo {
    height: 44px;
    width: auto;
}
.header-icons {
    display: flex;
    gap: 7px;
    color: inherit;
}
.header-btn {
    background: rgba(255,255,255,0.06);
    border: none;
    padding: 0.rem 0.1rem;
    border-radius: 50%;
    font-size: 1.7rem;
    color: inherit;
    cursor: pointer;
    transition: background 0.2s, box-shadow 0.2s, color 0.2s;
    box-shadow: 0 2px 8px 0 rgba(0,0,0,0.04);
    position: relative;
}
.header-btn:hover, .header-btn:focus {
    background: rgba(255,255,255,0.14);
    color: #ffcb05;
    outline: none;
    
}
#user-btn.active {
    background: #ffcb05;
    color: #222;
}

#register-notification {
    position: fixed;
    top: 80px;
    right: 10px;
    background: rgba(40, 40, 60, 0.98);
    border-radius: 12px;
    box-shadow: 0 8px 32px 0 rgba(0,0,0,0.19);
    padding: 12px;
    z-index: 1002;
    width: min(94vw, 320px);
    max-width: 320px;
    min-width: 220px;
    display: none;
    animation: fadeInNotif 0.4s;
}
#register-notification.show {
    display: block;
}

.register-container {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 0.7rem;
}
.register-actions {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
    margin-top: 0.5rem;
}
.register-link, .login-link {
    padding: 0.5rem 1.2rem;
    border-radius: 24px;
    background: #ffcb05;
    color: #222;
    text-decoration: none;
    font-weight: 600;
    box-shadow: 0 3px 14px 0 rgba(255,203,5,0.08);
    transition: background 0.2s, color 0.2s;
    border: none;
}
.register-link:hover, .login-link:hover {
    background: #fcd800;
    color: #180022;
}
.close-btn {
    background: none;
    border: none;
    color: #ffcb05;
    font-size: 1.5em;
    position: absolute;
    top: 12px;
    right: 12px;
    cursor: pointer;
}
@keyframes fadeInNotif {
    from { opacity: 0; transform: translateY(-20px);}
    to { opacity: 1; transform: translateY(0);}
}
/* ‚è≥‚úîÔ∏èSite 1 CSS ya kare daga nan */


/* üö¶‚úîÔ∏èSite 2 CSS ya fara daga nan */
#site2-container {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    padding: 24px 5vw 18px 5vw;
    width: 100%;
    background: rgba(0,0,0,0.09);
}

.site2-menu {
    display: flex;
    justify-content: space-between;
    width: 100%;
    max-width: 700px;
    gap: 16px;
}

.site2-menu-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    gap: 6px;
    padding: 8px;
    border-radius: 14px;
    transition: all 0.2s ease-in-out;
}

.site2-menu-item:hover {
    background: rgba(255, 203, 5, 0.1);
    filter: brightness(1.2);
    transform: translateY(-2px);
}

.menu-img {
    width: 52px;
    height: 52px;
    border-radius: 14px;
    object-fit: cover;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

.site2-menu-item span {
    font-size: 14px;
    font-weight: 500;
    text-align: center;
    color: inherit;
}

/* View Counter Styling (yanzu Status ne) */
.site2-view-anim {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(255,255,255,0.07);
    border-radius: 14px;
    padding: 10px 16px;
    min-width: 100px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
}

.site2-view-anim:hover {
    transform: scale(1.05);
}

.site2-view-anim i {
    font-size: 2.1rem;
    color: #ffcb05;
    margin-bottom: 6px;
}

/* An cire #view-count saboda ba a bukatarsa */
.site2-viewcount-text {
    font-size: 13px;
    color: #aaf;
    margin-top: 2px;
}
/* ‚è≥‚úîÔ∏èSite 2 CSS ya kare daga nan */


/* üö¶‚úîÔ∏èSite 3 CSS ya fara daga nan */
#site3-leagues {
    width: 100%;
    padding: 0.2rem 0.1rem 1.4rem 0.2rem;
    box-sizing: border-box;
    overflow-x: auto;
}
.leagues-scroller {
    display: flex;
    gap: 2.1rem;
    
    overflow-x: auto;
    padding-bottom: 1.2rem;
    scroll-snap-type: x mandatory;
}
.league-card {
    min-width: 92px;
    max-width: 110px;
    display: flex;
    flex-direction: column;
    align-items: center;
    
    background: #ffcb05;
    box-shadow: 0 1px 8px rgba(0,0,0,0.06);
    cursor: pointer;
    padding: 0.6rem 0.5rem 0.7rem 0.5rem;
    transition: box-shadow 0.16s, background 0.16s, color 0.14s;
    scroll-snap-align: start;
    border: 2px solid #fff2;
    
    background: rgba(255,255,255,0.08);
    border-radius: 16px;
    padding: 8px 10px;
}
.league-card img {
    width: 50px;
    height: 50px;
    
    border-radius: 8px;
    object-fit: cover;
    margin-bottom: 0.5rem;       
    
}
.league-card span {
    font-size: 0.92rem;
    font-weight: 600;
    text-align: center;
    color: inherit;
}
.league-card:hover, .league-card:focus {
    
    color: #222;
    border-color: #ffcb05;
    
}
/* ‚è≥‚úîÔ∏èSite 3 CSS ya kare daga nan */

/* siteüö¶‚úîÔ∏è 4 ya fara daga nan */
#site4-sarki {
    width: 100%;
    margin: 0 auto 1.5rem auto;
    box-sizing: border-box;
    position: relative;
    padding: 0;
}

/* Tab style a saman container */
.sarki-tab-container {
    position: relative;
    width: 100%;
    max-width: 650px;
    margin: 0 auto;
    height: 0px;
    z-index: 10;
}

.sarki-tab-title {
    position: absolute;
    top: -40px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 32px 12px 32px;
    font-weight: 700;
    font-size: clamp(1rem, 2vw, 1rem);
    color: #fff;
    background: linear-gradient(135deg, #ff512f 0%, #dd2476 100%);
    border-radius: 0 0 18px 18px;
    white-space: nowrap;
    letter-spacing: 0.01em;
    box-shadow: 0 7px 18px 0 #18002233;
    clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%);
    z-index: 10;
    line-height: 1.0;
    min-width: 230px;
    text-align: center;
    border-bottom: 2px solid #fff5;
}

.sarki-tab-title .sarki-tab-name {
    display: inline-block;
    max-width: 340px;
    white-space: pre;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: inherit;
    vertical-align: middle;
}

@media (max-width: 700px) {
    .sarki-tab-title {
        font-size: 0.95rem;
        min-width: 160px;
        padding: 10px 16px;
    }
    .sarki-tab-title .sarki-tab-name {
        max-width: 160px;
    }
}

/* Main Container */
.sarki-container {
    position: relative;
    width: 100%;
    min-height: 250px;
    max-width: 650px;
    margin: 0 auto 1.2rem auto;
    border-radius: 0px;
    overflow: hidden;
    box-shadow: 0 6px 32px 0 rgba(18, 0, 40, 0.20);
    background: #222;
    display: flex;
    align-items: stretch;
    z-index: 2;
    transition: box-shadow 0.23s;
    margin-top: 35px;
}

/* Background image or fallback */
.sarki-bg,
.sarki-bg-fallback {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    left: 0;
    top: 0;
    z-index: 1;
    filter: brightness(0.80) contrast(1.08);
    transition: filter 0.23s;
}

.sarki-bg-fallback {
    background: linear-gradient(135deg, #180022 0%, #300040 66%, #fff 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.5rem;
    color: #fff;
}

/* Gradient overlay */
.sarki-overlay {    
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1.1rem 1.3rem 1rem 1.3rem;
    background: linear-gradient(180deg, rgba(40, 5, 60, 0.63) 0%, rgba(20, 10, 3, 0.10) 70%, rgba(20, 20, 20, 0.07) 100%);
}

.sarki-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: .4rem;
    width: 100%;
    
}

.sarki-info {
    flex: 1 1 0;
    min-width: 0;
}

.sarki-fullname {
    font-size: clamp(1.1rem, 2.9vw, 2.5rem);
    font-weight: 900;
    line-height: 1.1;
    color: #fff;
    text-shadow: 2px 5px 15px #180022cc;
    margin-bottom: 0.11em;
    word-break: break-all;
}

.sarki-fullname.auto-scale {
    font-size: clamp(1rem, 2vw, 1.4rem);
}

.sarki-congrats {
    font-size: clamp(0.89rem, 1.4vw, 1rem);
    margin-bottom: 0.12em;
    color: #f7f7f7;
    text-shadow: 1px 1px 7px #180022;
    font-weight: 500;
}

.sarki-score-row {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: clamp(0.9rem, 1.2vw, 1rem);
    font-weight: 600;
    color: #fff;
    margin-bottom: 0.15em;
    text-shadow: 1px 1px 6px #180022bb;
    justify-content: flex-start;
    
}

.sarki-score-logo {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: #fff;
    object-fit: cover;
   
    border: 1px solid #fff;
    margin-inline: 0.10em;
}

.sarki-score-team {
    font-weight: 700;
    font-size: clamp(0.8rem, 1.2vw, 10px;);
  line-height: 1.0;
    margin: 0 0.1em;
    color: #ffcb05;
    white-space: nowrap;
    text-shadow: 0 2px 8px #180022bb;
}

/* New: Comment section */
.sarki-comment {
    background: rgba(255, 255, 255, 0.12);
    padding: 0.6rem;
    border-radius: 12px;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}

.sarki-comment .comment-text {
    font-size: 0.8rem;
    line-height: 1.1;
    color: #fff;
    margin: 0;
}

.sarki-comment .read-more-btn {
    color: #ffcb05;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.75rem;
    margin-top: 0.3em;
    display: inline-block;
}

/* If audio exists, show audio row */
.sarki-audio-row {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    background: rgba(255, 255, 255, 0.18);
    border-radius: 16px;
    padding: 0.5em 0.7em;
    margin-bottom: 0.15em;
}

.sarki-audio-player {
    flex: 1 1 0;
    min-width: 0;
    width: 120px;
    accent-color: #ffcb05;
    height: 2.1em;
}

.sarki-audio-profile,
.sarki-audio-clublogo {
    width: 30px;
    height: 30px;
    object-fit: cover;
    border-radius: 50%;
    border: 2px solid #fff;
    background: #fff;
}

.sarki-time {
    font-size: clamp(0.8rem, 1vw, 0.9rem);    
    margin-top: 0.28em;
    color: #ffe;
    text-shadow: 1px 1px 4px #18002299;
}

.sarki-profile {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0rem;
    margin-left: 0; 
    position: relative;
    flex-shrink: 0;
    
}

.sarki-profile-img {
    width: 100px;  
    height: 100px;
    border-radius: 20%;
    border: 5px solid #ffcb05;
    object-fit: cover;
    margin-bottom: 0.2rem;
    background: #fff;
    box-shadow: 0 6px 22px 0 #ffcb0552, 0 0 0 5px #fff;
    transition: box-shadow 0.23s, border-color 0.23s;
    cursor: pointer;
    z-index: 30;
}

.sarki-profile-img:active {
    box-shadow: 0 0 0 7px #ffcb05bb;
}

.sarki-club-img {
    position: absolute;
    width: 50px;  
    height: 50px;
    border-radius: 50%;
    border: 2.6px solid #fff;
    top: -5px;    
    right: 0px;    
    background: #fff;
    object-fit: cover;
    box-shadow: 0 2px 9px 0 #ffcb050a;
    z-index: 31;
}

.sarki-user-info {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 0.4em;
    background: rgba(0, 0, 0, 0.4);    
    padding: 0.3em 0.5em;
    border-radius: 20px;
}

.sarki-user-profile-logo {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    margin-right: 0em;
    object-fit: cover;
}

.sarki-username {
    font-size: 0.8rem;
    font-weight: 500;
    color: #fff;
    white-space: nowrap;
}

/* Bottom: Like, count */
.sarki-bottom {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 1.2rem;
}

.sarki-love-btn {
    background: rgba(255, 255, 255, 0.11);
    border: none;
    border-radius: 50%;
    padding: 0.6rem 1.0rem;
    font-size: 2.1rem;
    color: #ffcb05;
    cursor: pointer;
    transition: background 0.23s, transform 0.18s;
    animation: heartBeat 2.3s infinite;
    box-shadow: 0 2px 9px 0 #ffcb0512;
    position: relative;
    outline: none;
}

.sarki-love-btn:active,
.sarki-love-btn:focus,
.sarki-love-btn.loved,
.sarki-love-btn.loved:hover {
    background: green;
    color: red;
    transform: scale(1.18);
    animation: none;
}

.sarki-love-btn.loved::after {
    content: '‚úîÔ∏è';
    position: absolute;
    top: -0px;
    left: 60%;
    transform: translateX(-50%);
    font-size: 1.1rem;
    color: #23c24b;
    background: none;
    border-radius: 50%;
    padding: 1px 8px;
    pointer-events: none;
}

@keyframes heartBeat {
    0%,
    100% {
        transform: scale(1);
    }
    60% {
        transform: scale(1.16);
    }
}

.sarki-love-count {
    font-size: 1.35rem;
    font-weight: 700;
    margin-left: 0.48rem;
    color: #ffcb05;
    text-shadow: 1px 1px 6px #18002299;
    letter-spacing: 0.02em;
}

@media (max-width: 700px) {
    .sarki-container {
        max-width: 99vw;
        border-radius: 13px;
    }
    .sarki-profile-img {
        width: 90px;
        height: 90px;
    }
    .sarki-club-img {
        width: 28px;
        height: 28px;
        top: 0;
        right: 0;
    }
    .sarki-overlay {
        padding: 0.7rem 0.6rem 0.7rem 1rem;
    }
    .sarki-user-info {
        display: none;
        /* Boye sunan a kananan screens */
    }
}

/* Modal styles for profile image preview */
.sarki-modal {
    display: none;
    position: fixed;
    z-index: 99999;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(18, 0, 40, 0.14);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    transition: background 0.21s;
}

.sarki-modal.show {
    display: flex;
}

.sarki-modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(18, 0, 40, 0.25);
    z-index: 1;
}

.sarki-modal-content {
    position: relative;
    z-index: 2;
    background: #fff;
    border-radius: 21px;
    box-shadow: 0 12px 44px 0 #18002277;
    padding: 1.2rem 1.3rem 1.1rem 1.3rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 260px;
    min-height: 170px;
    max-width: 98vw;
    max-height: 95vh;
}

.sarki-modal-img-wrapper {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

.sarki-modal-profile-img {
    width: 250px;
    height: 250px;
    border-radius: 16px;
    object-fit: cover;
    background: #eee;
    box-shadow: 0 8px 44px 0 #ffcb0552;
    border: 5px solid #ffcb05;
    max-width: 84vw;
    max-height: 72vh;
}

.sarki-modal-club-img {
    position: absolute;
    left: 60%;
    top: 10px;
    transform: translateX(-50%);
    width: 82px;
    height: 82px;
    border-radius: 50%;
    border: 3.5px solid #fff;
    background: #fff;
    object-fit: cover;
    box-shadow: 0 2px 9px 0 #ffcb050a;
}
.sarki-modal-usernam2{
    font-size: 1.2rem;
    font-weight: bold;
    color: #444;
    
}
.sarki-modal-username {
    font-size: 1rem;
    font-weight: bold;
    color: #444;
    margin-top: 0.8rem;
    text-align: center;
}

.sarki-modal-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(255, 255, 255, 0.93);
    border: none;
    font-size: 2rem;
    color: #c00;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 6px #18002233;
    z-index: 3;
    transition: background 0.18s;
}

.sarki-modal-close:active {
    background: #ffd8d8;
}

@media (max-width: 600px) {
    .sarki-modal-profile-img {
        width: 94vw;
        height: 94vw;
        max-width: 98vw;
        max-height: 90vh;
    }
    .sarki-modal-club-img {
        width: 36px;
        height: 36px;
        top: 7px;
    }
    .sarki-modal-content {
        padding: 0.6rem 0.5rem 0.6rem 0.5rem;
    }
}

.sarkiIm{
    width: 250px;
    height: 250px;
}

/* siteüö¶‚úîÔ∏è 4 ya kare daga nan */



/* üö¶‚úîÔ∏èSite 5 CSS ya fara daga nan */

/* ‚úçÔ∏è‚òÄÔ∏èSite 5 CSS ya fara daga nan (gyarawa da karin zamani) */
#site5-kaitsayepost {
    width: 100%;
    max-width: 800px;
    margin: 0 auto 0.4rem auto;
    min-height: 170px;
    box-sizing: border-box;
    font-family: 'Segoe UI', Arial, sans-serif;
}

.kaitsaye-post-container {
  
    width: 96%;
     margin-bottom: 2rem;
    padding: 0;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    border-top: 4px solid;
    border-bottom: 4px solid;
    border-image: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet) 1;
    border-radius: 0px;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
}

@keyframes site5-fadein {
    from {
        opacity: 0;
        transform: scale(0.97);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.kaitsaye-post-container:hover {
    box-shadow: 0 8px 60px 0 #18002277, 0 1.5px 14px #4a00e041;
    transform: translateY(-4px) scale(1.005);
}

.kaitsaye-top-bar {
    background: linear-gradient(to right, #8e2de2, #4a00e0);
    border: 2.2px solid #6f42c1;
    border-radius: 15px 15px 0 0;
    box-shadow: inset 0 -3px 8px rgba(0, 0, 0, 0.36);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2px;
    padding: 0.48rem 0.9rem 0.42rem 0.9rem;
    position: relative;
    min-height: 52px;
    z-index: 2;
}

.kaitsaye-top-bar-logo {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: #fff;
    object-fit: contain;
    border: 2.5px solid #ffcb05;
    margin-right: 0.7rem;
    box-shadow: 0 1px 8px #ffcb0570;
    transition: box-shadow 0.16s;
}

.kaitsaye-top-bar-logo:hover {
    box-shadow: 0 2px 16px #fde000c6;
}

.kaitsaye-top-title {
    font-size: 1.22rem;
    font-weight: 700;
    color: #fff;
    letter-spacing: 0.7px;
    text-shadow: 0 1px 5px #30004099;
    display: flex;
    align-items: center;
    gap: 0.4rem;
}

.kaitsaye-top-title i {
    color: #ffcb05;
    font-size: 1.22rem;
    animation: site5-bounce 1.7s infinite;
}

@keyframes site5-bounce {
    0%,
    100% {
        transform: translateY(0);
    }
    14% {
        transform: translateY(-3px);
    }
    28% {
        transform: translateY(1px);
    }
    70% {
        transform: translateY(-2px);
    }
}

.kaitsaye-top-bar-time {
    margin-left: auto;
    font-size: 13px;
    color: #fde000;
    font-weight: 600;
    opacity: 0.87;
    display: flex;
    align-items: center;
    gap: 0.1rem;
}

.kaitsaye-content {
    width: 100%;
    display: flex;
    flex-direction: column;    
    gap: 0;
    margin: 0;
    z-index: 1;
    background-color: #1a1a1a; 
}

.kaitsaye-post-text {
    font-size: clamp(15px, 1.12vw, 22px);
    font-weight: 600;
    color: #ffcb05;
    line-height: 1.27;
    max-width: 100%;
    overflow: hidden;
    word-break: break-word;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
    padding-bottom: 5px; 
    margin-bottom: 0; 
    text-shadow: 0 2px 9px #180022c0;
    transition: font-size 0.22s;
    letter-spacing: 0.03em;
    background: linear-gradient(90deg, #ffcb05 60%, #fffbe2 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
}

.kaitsaye-post-media-box {
    width: 100%; 
    background: transparent; 
    border-radius: 20px;
    margin-top: 15px; 
    margin-bottom: 0;
    position: relative;
    box-shadow: 0 1.5px 18px #18002238; 
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    min-height: auto; 
}

/* Tsarin zamani na Audio Player */
.kaitsaye-audio-player-box {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px 0;
    box-sizing: border-box;
    z-index: 9999;
    background: #2b2b2b; 
    border-radius: 10px;
    padding: 15px;
    margin-top: 15px; 
    margin-bottom: 0; 
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); 
    overflow: hidden;
}

.kaitsaye-audio-player {
    background: linear-gradient(115deg, #ffcb05 60%, #8e2de2 100%);
    border-radius: 30px;
    padding: 0.5rem 1.5rem 0.5rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.8rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.4);
    min-width: 250px;
    max-width: 400px;
    transition: all 0.2s ease-out;
}

.kaitsaye-audio-player:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
}

.kaitsaye-audio-player .audio-progress {
    height: 7px;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 5px;
    margin: 0 0.7rem 0 0.7rem;
    flex: 1;
    position: relative;
    overflow: hidden;
    cursor: pointer;
}

.kaitsaye-audio-player .audio-progress-bar {
    width: 0;
    height: 100%;
    background: #8e2de2;
    border-radius: 5px;
    transition: width 0.15s linear;
}

.kaitsaye-audio-player .audio-play-btn {
    color: #8e2de2;
    background: #fff;
    border-radius: 50%;
    border: none;
    width: 35px;
    height: 35px;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-right: 0.3rem;
    box-shadow: 0 1px 7px rgba(142, 45, 226, 0.4);
    transition: background 0.18s, color 0.18s, box-shadow 0.13s, transform 0.15s;
}

.kaitsaye-audio-player .audio-play-btn:hover {
    background: #8e2de2;
    color: #fff;
    box-shadow: 0 3px 14px rgba(142, 45, 226, 0.6);
    transform: scale(1.05);
}

.kaitsaye-audio-player .audio-time {
    font-size: 1rem;
    min-width: 45px;
    color: #222;
    font-weight: 700;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.6);
}

/* Tsarin Rediyo Kai Tsaye */
.rediyo-kai-tsaye-player {
    position: relative;
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
    background: #1a1a1a;
    border-radius: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin-top: 5px; 
    margin-bottom: 0;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); 
    min-height: 0;
}

.rediyo-kai-tsaye-player.has-image {
    min-height: auto;
}

.rediyo-kai-tsaye-player img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 0;
}

/* NEW: Class for the background image within the rediyo player */
.rediyo-kai-tsaye-player .rediyo-background-image {
    filter: brightness(0.6);
    width: 100%;
    height: 100%; 
    object-fit: contain;
    object-position: center;
    position: absolute; 
    top: 0;
    left: 0;
    z-index: 0;
    border-radius: 0;
}

.rediyo-kai-tsaye-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); 
    z-index: 1;
    display: flex;
    justify-content: center;
    align-items: center;
}

.rediyo-kai-tsaye-controls {
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.15);
    padding: 20px;
    border-radius: 15px;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.rediyo-kai-tsaye-button {
    background: linear-gradient(to right, #ffcb05, #fd6d00);
    color: #222;
    border-radius: 50%;
    border: none;
    width: 60px; /* Larger button */
    height: 60px;
    font-size: 2.2rem; /* Larger icon */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease-out;
}

.rediyo-kai-tsaye-button:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
}

.rediyo-kai-tsaye-title {
    color: #fff;
    font-size: 1.4rem;
    font-weight: 700;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    margin-top: 10px;
    text-align: center;
}

/*‚úîÔ∏èstyle na icon comment love */
.kaitsaye-actions-bar {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-evenly;
    gap: 0px;
    border-radius: 0 0 15px 15px;
    background: linear-gradient(to right, #4a00e0, #8e2de2);
    padding: 0.3rem 0;
    box-shadow: inset 0 3px 8px rgba(0, 0, 0, 0.36);
    margin-top: 0;
    border-top: none; 
    padding-top: 0; 
}

.kaitsaye-action-btn {
    display: flex;
    align-items: center;
    gap: 0.37rem;
    font-size: 1.14rem;
    color: #ffcb05;
    font-weight: 700;
    background: none;
    border: none;
    outline: none;
    cursor: pointer;
    transition: color 0.16s, transform 0.13s, background 0.14s;
    position: relative;
    padding: 0.12rem 0.5rem;
    border-radius: 10px;
}

.kaitsaye-action-btn i {
    font-size: 1.22rem;
    margin-right: 0.24rem;
    text-shadow: 0 1px 6px #fff2;
}

.kaitsaye-action-btn:hover,
.kaitsaye-action-btn.active {
    color: #46eb8d;
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.kaitsaye-action-btn.download:hover {
    color: #fd6d00;
    background: rgba(253, 109, 0, 0.15);
}

.kaitsaye-action-btn.share:hover {
    color: #4a00e0;
    background: rgba(74, 0, 224, 0.15);
}

.kaitsaye-action-btn.love.active {
    color: #fd6d00;
    background: rgba(253, 109, 0, 0.15);
}

@keyframes love-pop {
    0% {
        transform: scale(1.6);
    }
    60% {
    transform: scale(0.9);
    }
    100% {
        transform: scale(1.12);
    }
}

.kaitsaye-action-badge {
    background: #fde000;
    color: #222;
    border-radius: 14px;
    font-size: 0.95rem;
    font-weight: 700;
    padding: 0.17rem 0.30rem;
    margin-left: 0.1rem;
    min-width: 28px;
    text-align: center;
    display: inline-block;
    box-shadow: 0 1px 5px #ffcb0542;
}

.kaitsaye-post-container .fa-spinner {
    color: #ffcb05;
    font-size: 2.4rem;
    margin-bottom: 0.6rem;
    animation: site5-spin 1.4s linear infinite;
}

@keyframes site5-spin {
    0% {
        transform: rotate(0);
    }
    100% {
        transform: rotate(360deg);
    }
}



/* Push Notification Container Style */
.site5-push-container {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(to right, #4a00e0, #8e2de2);
    color: #fff;
    padding: 12px 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.1rem;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}

.site5-push-container.show {
    opacity: 1;
    visibility: visible;
}

.site5-push-container i {
    font-size: 1.3em;
}

/* Loading Spinner */
.kaitsaye-loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
}

/* The video itself (within kaitsaye-video-container) */
.site5-kaitsaye-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* Fullscreen button on the video thumbnail */
.video-fullscreen-btn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    font-size: 16px;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: background-color 0.3s ease;
}

.video-fullscreen-btn:hover {
    background: rgba(0, 0, 0, 0.8);
}

/* Viewer container for the fullscreen video */
.kaitsaye-video-fullscreen-viewer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.kaitsaye-video-fullscreen-viewer.active {
    opacity: 1;
    visibility: visible;
}

/* The video iframe inside the fullscreen viewer */
.kaitsaye-fullscreen-video-frame {
    width: 100%;
    height: 100%;
}

/* Close button on the fullscreen video */
.kaitsaye-video-fullscreen-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    transition: background-color 0.3s ease;
}

.kaitsaye-video-fullscreen-close-btn:hover {
    background: rgba(255, 255, 255, 0.4);
}

/* General media element styling within media box */
.kaitsaye-post-media-box img,
.kaitsaye-post-media-box video,
.kaitsaye-post-media-box iframe {
    width: 100%;
    height: 100%;
    object-fit: cover; 
    object-position: center;
    background: transparent;
    display: block;
    margin: 0 auto;
    border-radius: 0px;
}

.kaitsaye-video-container {
    position: relative;
    width: 100%;
    padding-top: 56.25%; 
    height: 0;
    overflow: hidden;
    border-radius: 0px;
}


.kaitsaye-video-container .video-play-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 2.5rem;
    opacity: 1;
    z-index: 5;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    width: 80px;
    height: 80px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background 0.3s ease;
}

.kaitsaye-video-container .video-play-btn:hover {
    background: rgba(0, 0, 0, 0.8);
}
/* ‚úçÔ∏èüëΩSite5 CSS ya kare daga nan */



/* üö¶‚úîÔ∏èSite 6 CSS ya fara daga nan */
#site6-wasanninyau {
    width: 100%;
    max-width: 900px;
    margin: 0 auto 1.5rem auto;
    min-height: 80px;
    box-sizing: border-box;
}
#site6-navbar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.2rem;
    margin-bottom: 0.7rem;
    font-size: 1.15rem;
    font-weight: bold;
}
#site6-dateDisplay {
    font-size: 1.12rem;
    font-weight: 700;
    letter-spacing: 0.02em;
}
.wasanni-scroller {
    display: flex;
    gap: 1.2rem;
    overflow-x: auto;
    padding-bottom: 0.2rem;
    scroll-snap-type: x mandatory;
}
.wasanni-card {
    min-width: 215px;
    max-width: 230px;
    background: rgba(255,255,255,0.08);
    border-radius: 15px;
    box-shadow: 0 1px 8px rgba(0,0,0,0.12);
    padding: 0.7rem 0.9rem;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    position: relative;
    cursor: pointer;
    transition: background 0.18s, box-shadow 0.14s, border 0.14s;
    border: 2px solid transparent;
    scroll-snap-align: start;
}
.wasanni-card:hover {
    background: #ffcb05;
    color: #222;
    border-color: #ffcb05;
}
.wasanni-card.site6-finished {
    border-color: #43a047;
}
.wasanni-card.site6-finished:hover {
    background: #43a047;
    color: #fff;
}
.wasanni-teams {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.6rem;
}
.wasanni-team {
    display: flex;
    align-items: center;
    gap: 0.43rem;
}
.wasanni-team-logo {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    background: #fff;
}
.wasanni-team-name {
    font-size: 1.08rem;
    font-weight: 700;
}
.wasanni-vs {
    font-size: 1.11rem;
    font-weight: 800;
    color: #ffcb05;
    margin: 0 0.9rem;
}
.wasanni-time {
    font-size: 0.96rem;
    font-weight: 500;
    color: #ffe;
    margin-top: 0.4rem;
}
.wasanni-status {
    font-size: 0.87rem;
    font-weight: 600;
    margin-top: 0.15rem;
    color: #222;
}
.site6-finished .wasanni-status {
    color: #43a047;
    font-weight: bold;
}
#site6-loader {
    font-size: 1.6rem;
    color: #ffcb05;
}
@media (max-width: 600px) {
    .wasanni-card {
        min-width: 90vw;
        max-width: 92vw;
    }
}
/* ‚è≥‚úîÔ∏èSite 6 CSS ya kare daga nan */





/* üö¶‚úîÔ∏èSite 7 CSS ya fara daga nan */
/* üí†‚öΩ Wasanni Masu Zafi ‚öΩüí† Modern Site 7 CSS */

#site7-wasaninmasuzabi {
    width: 100%;
    max-width: 900px;
    margin: 0 auto rem auto;
    min-height: 100px;
    box-sizing: border-box;
    overflow-x: hidden;
    position: relative;
    padding-bottom: 0.5rem;    
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
    
    
}

.aite7-title-bar {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.9rem;
    font-size: 1.3rem; 
    font-weight: 800; 
    margin-bottom: 1.5rem; 
    letter-spacing: 0.8px;
    opacity: 0.95;
    user-select: none;    
    text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
    
      border-top: 4px solid;
    border-bottom: 4px solid;
    border-image: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet) 1;
    
     
}

.aite7-scroller-container {
    position: relative;
    width: 100%;
    overflow: hidden;    
     
}

.aite7-scroller {
    display: flex;
    gap: 1.8rem; 
    overflow-x: auto;
    padding-bottom: 0.5rem;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch; 
    scrollbar-width: none; 
    -ms-overflow-style: none; 
}

.aite7-scroller::-webkit-scrollbar {
    display: none; 
}

.aite7-card {
    min-width: 300px; 
    max-width: 350px;
    border-radius: 20px;
     
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); 
    padding: 1.5rem 1.2rem; 
    display: flex;
    flex-direction: column;
    align-items: center; 
    position: relative;
    margin-bottom: 0.5rem;
    cursor: default; 
    transition: all 0.2s ease-in-out; 
    border: 0px solid #e0e0e0; 
}

.aite7-card:hover {
    
    box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
}

.aite7-img-wrap {
    position: relative;
    width: 100%;
    height: 180px; 
    border-radius: 18px; 
    overflow: hidden;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, #eaf6fb, #d4e7f7); 
    display: flex;
    align-items: center;
    justify-content: center;
}

.aite7-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    border-radius: 18px;
    transition: transform 0.3s ease-out;
}

.aite7-img-wrap:hover .aite7-img {
    transform: scale(1.03); 
}

.aite7-img-hover {
    position: absolute;
    left: 0; top: 0; right: 0; bottom: 0;
    pointer-events: none;
    background: linear-gradient(180deg, rgba(45,144,255,0.15) 0%, rgba(22,22,22,0.02) 100%);
    opacity: 1; 
    border-radius: 18px;
}
.aite7-game-row {
    display: flex;
    align-items: center;
    justify-content: center; 
    width: 100%;
    margin-bottom: 0.8rem;
    gap: 1.2rem;
    position: relative;
     
}


/* New: Flex container for the team row */
.aite7-teams {
    display: flex;
    align-items: center;
    justify-content: space-between; 
    width: 100%;
    font-size: 1.15rem; 
    font-weight: bold;
    margin-bottom: 0.8rem;
}

/* New: Styles for each team's column (logo and name) */
.aite7-team-col {
    display: flex;
    flex-direction: column; 
    align-items: center; 
    flex: 1; 
    min-width: 0;
    gap: 0.0rem;
}

/* Modified: Reduced logo size */
.aite7-game-logo {
    width: 35px; 
    height: 35px; 
    border-radius: 50%;
    object-fit: cover;
    background: #fff;
    margin-bottom: 0.2rem;
    border: 3px solid #fdd835; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.aite7-game-name {
    font-size: 1.05rem; 
    font-weight: 800; 
    text-align: center;
    color: #fff155; 
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 120px;
}

.aite7-vs-label {
    font-size: 2.25rem; 
    font-weight: 900;
    color: #f59e0b; 
    margin: 0 0.6rem;
    user-select: none;
    letter-spacing: 2.5px;
    display: flex;
    align-items: center;
    gap: 0.1rem;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.aite7-game-time {
    font-size: 1.05rem;
    font-weight: 600;
    color: #555; /* Neutral color */
    text-align: center;
    margin-bottom: 1rem;
    padding: 0.1rem 0.8rem;
    background: #f0f0f0;
    border-radius: 15px;
}

.aite7-score-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 12px;
    gap: 1rem;
}

.aite7-vote-box {
    background: #f5f5f5;
    padding: 1px 14px;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    flex: 1; 
    transition: all 0.3s ease;
    position: relative;
    border: 1px solid #eee;
}

.aite7-vote-box.voted {
    background: #4CAF50; 
    color: white;
    border-color: #4CAF50;
    box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
}

.aite7-vote-box.voted .aite7-vote-indicator {
    background: linear-gradient(to right, #22c55e, #10b981); 
}

.aite7-vote-box.voted .aite7-team-icon {
    color: white;
}
.aite7-vote-box.voted .aite7-box-count {
    color: white; 
}

.aite7-vote-box.disabled {
    opacity: 0.6;
    cursor: not-allowed;
    pointer-events: none;
}

.aite7-vote-box .aite7-check-mark {
    font-size: 1.3rem;
    position: absolute;
    top: -8px;
    right: -8px;
    background: #4CAF50;
    color: white;
    border-radius: 50%;
    width: 25px;
    height: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.aite7-team-icon {
    font-size: 1.0rem;
    color: #2d90ff; 
}

.aite7-box-count {
    font-size: 1.1rem;
    font-weight: 700;
    color: #444; 
    margin-left: 0.2rem;
}

.aite7-vote-indicator {
    margin-top: 8px;
    height: 6px;
    width: 100%;
    border-radius: 4px;
    background: #ccc; 
    transition: background 0.4s ease;
}

.aite7-divider {
    font-size: 1.5rem;    
    font-weight: bold;
}

.aite7-poster {
    margin-bottom: 1rem;
    width: 100%;
    text-align: center;
}

.aite7-poster img {
    width: 100%;
    max-height: 250px; 
    object-fit: cover;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    cursor: pointer; 
}

.aite7-content {
  font-size: 1rem;
  margin-bottom: 12px;
  line-height: 1.5;
  text-align: justify;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 4; 
  -webkit-box-orient: vertical;
  position: relative;
}

.aite7-read-more {

color: green;
    font-weight: 900;
    cursor: pointer;
    font-size: 1.05em;
    text-decoration: underline;
    margin-left: 0.3em;
    
         
}

.aite7-audio-player-wrap {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 0.8rem;
    background: linear-gradient(90deg, #e9f5ff, #f3f7fa);
    border-radius: 12px;
    padding: 0.5rem 0.8rem;
    min-width: 0;
    box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
}

.aite7-audio-btn {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: #2d90ff;
    cursor: pointer;
    transition: color 0.2s ease-in-out;
}

.aite7-audio-btn:hover {
    color: #1e70d4;
}

.aite7-audio-progress {
    flex: 1;
    appearance: none;
    height: 6px;
    border-radius: 7px;
    background: #d0e8ff;
    outline: none;
    cursor: pointer;
}

.aite7-audio-progress::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #2d90ff;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(45,144,255,0.5);
    transition: background 0.2s ease-in-out;
}

.aite7-audio-progress::-moz-range-thumb {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #2d90ff;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(45,144,255,0.5);
    transition: background 0.2s ease-in-out;
}

.aite7-audio-time {
    font-size: 0.9rem;
    color: #555;
    min-width: 70px;
    text-align: right;
    font-weight: 600;
}



.aite7-icon-item {
    
    gap: 9.4rem;
    border-radius: 0 0 15px 15px;
    padding: .3rem 1.0rem;
    
    box-shadow: inset 0 3px 8px rgba(0, 0, 0, 0.36);
    transition: background 0.3s ease;
    color: white;
    font-size: 1.0rem;
    font-weight: 500;
}

.aite7-icon-item:hover {
    background: #5e35b1;
    transform: translateY(-1px);
}

.aite7-icon-item i {
    font-size: 2.0rem;
    color: #fdd835;
    transition: color 0.2s ease-in-out;
}

.aite7-icon-item.liked i.fa-thumbs-up {
    color: #2d90ff; 
}

/* Container to hold all 4 icon buttons in a row */
.aite7-icon-row {
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
    gap: 2.0rem;
    width: 100%;
    margin-top: 1rem;
    
}


.aite7-count {
    font-size: 1.0rem !important;    
    color: #fdd835;
    min-width: 20px;
    text-align: center;
    font-weight: bold;
}

/* Modal for image view */
.aite7-image-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.aite7-image-modal img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.7);
}

.aite7-modal-close-btn, .aite7-modal-download-btn {
    position: absolute;
    background: none;
    border: none;
    color: #fff;
    font-size: 2.0rem;
    cursor: pointer;
    z-index: 10000;
    text-shadow: 0 0 5px rgba(0,0,0,0.5);
    transition: all 0.2s ease-in-out;
}

.aite7-modal-close-btn:hover, .aite7-modal-download-btn:hover {
    color: #ddd;
    transform: scale(1.1);
}

.aite7-modal-close-btn {
    top: 20px;
    right: 20px;
}

.aite7-modal-download-btn {
    bottom: 20px;
    right: 20px;
    font-size: 1.8rem;
    background: #2d90ff;
    padding: 10px 15px;
    border-radius: 50px;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 2px 10px rgba(45,144,255,0.4);
}

/* Modern left/right scroll icons */
.aite7-scroll-btn {
    position: absolute;
    top: 50%;
    z-index: 4;
    transform: translateY(-50%);
    width: 68px; /* Larger buttons */
    height: 68px;
    background: #2d90ff; /* Blue background */
    color: #fff;
    border-radius: 50%;
    font-size: 2.8rem; /* Larger icon */
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    box-shadow: 0 4px 12px rgba(45,144,255,0.4); /* Stronger shadow 
    
}

.aite7-scroll-btn:hover {
    background: #1e70d4;
    transform: translateY(-50%) scale(1.05);
    box-shadow: 0 6px 16px rgba(45,144,255,0.5);
}

.aite7-scroll-btn:active {
    background: #15803d;
    transform: translateY(-50%) scale(0.95);
}

.aite7-scroll-btn.aite7-left {
    left: -24px; /* Move slightly out */
}

.aite7-scroll-btn.aite7-right {
    right: -22px; /* Move slightly out */
}

.aite7-scroll-btn[hidden] {
    display: none;
}

/* Responsive adjustments */
@media (max-width: 500px) {
    .aite7-card {
        min-width: 90vw; /* Adjust for mobile */
        max-width: 95vw;
        padding: 1.2rem 0.8rem;
    }
    .aite7-img-wrap {
        height: 40vw;
        min-height: 150px;
    }
    .aite7-game-name {
        font-size: 1.05rem;
    }
    .aite7-vs-label {
        font-size: 1.1rem;
    }
    .aite7-audio-player-wrap {
        flex-wrap: wrap;
        justify-content: center;
        padding: 0.8rem 0.5rem;
    }
    .aite7-audio-time {
        min-width: auto;
    }
    .aite7-meta-info {
        flex-wrap: wrap;
        gap: 1rem;
    }
    .aite7-icon-item {
        flex-basis: 45%; 
    }
    .aite7-scroll-btn {
        width: 40px;
        height: 40px;
        font-size: 1.6rem;
        left: -15px;
        right: -15px;
    }
}
/* ‚è≥‚úîÔ∏èSite 7 CSS ya kare daga nan */


/* üö¶‚úîÔ∏èSite 8 CSS ya fara daga nan */
#site8-posting {
    width: 98%;
    max-width: 700px;
    margin: 0 auto 1rem auto;
    min-height: 70px;
    box-sizing: border-box;               
}

.no-posts {
    text-align: center;
    color: #888;
    font-size: 1rem;
    padding: 2px;
    
}

.posting-feed {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
}

.posting-card {      
    border-bottom: 2px solid;
    border-image: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet) 1;
    
}

 .posting-card.first-post {
    border: 2px solid yellow;
    border-radius: 15px;
} 


.posting-logo-row {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    font-size: 0.95rem;
    color: inherit;
}

.posting-logo-img {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    object-fit: cover;
    background: #fff;
    border: 2px solid #FFD700;
    flex-shrink: 0;
}

.posting-timestamp {
    font-size: 0.9rem;
    color: inherit;
    margin-left: auto;
}

.posting-text-below-logo {
    font-size: 1rem;
    font-weight: 500;
    color: inherit;   
    line-height: 1.4;
    margin: 0.5rem 0;
    white-space: pre-wrap; 
}


.posting-learnmore {
    color: green;
    font-weight: 700;
    cursor: pointer;
    font-size: 1.1em;
    text-decoration: underline;
    margin-left: 0.3em;
}


.posting-media {            
width: 100%;    
    border-bottom: 2px solid yellow;
    padding-bottom: 0.5rem;
    margin: 0.5rem 0 0.2rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 0.15rem;
    
}


.posting-img,
.posting-video {
            
    width: 100%;
    height: auto;
    object-fit: contain;
    border-radius: 5px;
    background: #222;
    margin-bottom: 0.18rem;
    max-height: 500px;
}

.posting-img-double-container {
    display: flex;
    width: 100%;
    gap: 0.15rem;
    justify-content: space-between;
}

.posting-img-double {
    width: 49.5%;
    height: auto;
    object-fit: cover;
    border-radius: 13px;
    background: #222;
    flex-grow: 1;
    max-height: 300px; 
}

.posting-audio-full-container {
    width: 100%;
    margin: 0.3rem 0;
}

.posting-audio-full {
    width: 100%;
    border-radius: 13px;
}

.posting-audio-container {
    width: 100%;
    margin-top: 0.5rem;
}

.posting-audio-controller {
    width: 100%;
    height: 40px; 
    border-radius: 5px;
}

.posting-audio-text-container {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    width: 100%;
    margin: 0.5rem 0;
}

.posting-audio-small {
    width: 100%;
    height: 30px; 
    border-radius: 5px;
}

.posting-bottom {
    display: flex;
    align-items: center;
    justify-content: space-around;
    font-size: 0.98rem;
    margin-top: 0.55rem;
    flex-wrap: wrap;
}

.posting-action {
    display: flex;
    align-items: center;
    gap: 0.34rem;
    cursor: pointer;
    color: yellow;
    transition: color 0.17s;
    font-size: 1.1rem;
    font-weight: bold;
}

.posting-action i {
    font-size: 2.0rem;
    color: yellow;
}

.posting-action.posting-action-like.active {
    color: blue;
}

.posting-action:hover {
    color: #ffd700;
}

/* Image viewer styles */
.site8-image-viewer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.site8-image-viewer.active {
    opacity: 1;
    pointer-events: auto;
}

.site8-image-viewer img {
    max-width: 100%;
    max-height: 80%;
    object-fit: contain;
    border-radius: 0px;
}

.site8-image-viewer-controls {
    position: absolute;
    top: 15px;
    right: 15px;
    display: flex;
    gap: 15px;
}

.site8-image-viewer-controls i {
    color: white;
    font-size: 2.5rem;
    cursor: pointer;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 50%;
}

.site8-image-viewer-controls i:hover {
    color: yellow;
}

.push-container {
    position: fixed;
    top: 1.8em;
    right: 1.5em;
    z-index: 9999;
    background: #222;
    color: #fff;
    padding: 0.9em 1.6em;
    border-radius: 10px;
    box-shadow: 0 0 12px #19c37d22;
    font-weight: 600;
    font-size: 1.06em;
    opacity: 0;
    transform: translateY(-20px);
    transition: opacity 0.3s, transform 0.3s;
    pointer-events: none;
}

.push-container.active {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
}

.posting-logo-row {
    display: flex;
    align-items: center;
    padding: 10px 15px;
    border-bottom: 1px solid #fff155;
}


/* Video Fullscreen Viewer */
.site8-video-fullscreen-viewer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.site8-video-fullscreen-viewer.active {
    opacity: 1;
    visibility: visible;
}

.site8-video-fullscreen-content {
    position: relative;
    width: 100%; 
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
}

.site8-fullscreen-video-frame {
    width: 100%;
    height: 100%;
    max-width: 100vw;
    max-height: 100vh;
}

.site8-video-fullscreen-close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1001; /* Above the video */
}

.site8-video-fullscreen-close-btn:hover {
    background: rgba(255, 255, 255, 0.4);
}


.posting-video-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
}

.posting-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.video-fullscreen-btn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    font-size: 16px;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    gap: 5px;
}

.video-fullscreen-btn:hover {
    background: rgba(0, 0, 0, 0.8);
}

/* CSS na YouTube video */
.posting-video-container.youtube-embed {
    position: relative;
    width: 100%;
    height: 0;
    padding-bottom: 56.25%; 
    overflow: hidden;
    cursor: pointer;
}

.youtube-thumbnail {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: opacity 0.3s ease;
}

.youtube-play-btn {
    color: #fff;
    font-size: 4rem;
    filter: drop-shadow(0 0 5px rgba(0,0,0,0.5));
    transition: color 0.2s ease;
}

.youtube-play-btn:hover {
    color: #ff0000;
}

.youtube-iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.youtube-iframe.hidden {
    display: none;
}

/* ‚è≥‚úîÔ∏èSite 8 CSS ya kare daga nan */



/* Responsive */
@media (max-width: 680px) {
    .site2-menu { max-width: 99vw; gap: 0.7rem;}
    #site2-container, #site3-leagues, #site4-sarki,
    #site5-kaitsayepost, #site6-wasanninyau,
    #site7-wasaninmasuzabi, #site8-posting { padding-left: 0; padding-right: 0;}
}
@media (max-width: 520px) {
    .leagues-scroller { gap: 0.6rem;}
    .league-card { min-width: 85px; max-width: 100px; padding: 0.4rem;}
    .posting-card, .kaitsaye-post-container { padding: 0.6rem 0.4rem;}
}


.header-btn {
  background: none;
  border: none;
  color: #fff;
  font-size: 1.45em;
  margin-left: 10px;
  cursor: pointer;
  transition: color .19s;
}
.header-btn:active,
.header-btn:hover {
  color: #7d3cff;
}

.push1-container {
  display: none;
  position: fixed;
  top: 85px;
  right: 50px;
  z-index: 9999;
  background: #29003d;
  color: #fff;
  border-radius: 13px;
  box-shadow: 0 4px 30px #7d3cff44;
  padding: 22px 20px 18px 18px;
  min-width: 220px;
  max-width: 96vw;
  transition: opacity .24s;
}
.push1-container.show {
  display: block;
  animation: push1-fade-in .21s;
}
@keyframes push1-fade-in {
  0% { opacity: 0; transform: scale(.96);}
  100% { opacity: 1; transform: scale(1);}
}
.push1-content {
  text-align: center;
}
.push1-content i {
  color: #7d3cff;
  font-size: 2.22em;
  margin-bottom: 8px;
  margin-top: 3px;
}
.push1-close {
  position: absolute;
  top: 7px;
  right: 11px;
  font-size: 1.5em;
  color: #fff;
  cursor: pointer;
  transition: color .18s;
}
.push1-close:hover { color: #ff4343; }
.push1-btn {
  padding: 7px 24px;
  background: #7d3cff;
  color: #fff;
  border: none;
  border-radius: 7px;
  margin: 0 4px;
  cursor: pointer;
  font-weight: 600;
  font-size: 1em;
  transition: background .15s;
}
.push1-btn-deny {
  background: #444;
}
.push1-btn:hover:not(.push1-btn-deny) {
  background: #a06cff;
}
.push1-btn-deny:hover {
  background: #6a3131;
}


.push1-modern-alert {
  position: fixed;
  top: 22px;
  right: 22px;
  z-index: 99999;
  min-width: 220px;
  max-width: 98vw;
  padding: 18px 30px 18px 26px;
  background: linear-gradient(90deg, #7d3cff 60%, #180022 120%);
  color: #fff;
  border-radius: 13px;
  box-shadow: 0 4px 26px #7d3cff44;
  font-family: 'Poppins', sans-serif;
  font-size: 1.09em;
  font-weight: 500;
  opacity: 0;
  pointer-events: none;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: opacity .25s, transform .23s;
  transform: translateY(-20px);
}
.push1-modern-alert.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}
.push1-modern-alert .icon {
  font-size: 1.6em;
  flex-shrink: 0;
  color: #ffe7ff;
  filter: drop-shadow(0 0 6px #fff3);
}

    </style>
</head>
<body>
   <!-- üö¶‚úîÔ∏èSite 1 HTML ya fara daga nan -->
<header id="site1-header">
    <div class="header-content">
        <img src="https://i.imgur.com/CgvdgMA.png" alt="Logo" class="logo" id="site1-logo">
        <div class="header-icons">
            <button class="header-btn" id="bg1-btn" title="Bacgraoud na 1">
                <i class="fa-solid fa-moon"></i>
            </button>
            <button class="header-btn" id="bg2-btn" title="Bacgraoud na 2">
                <i class="fa-solid fa-sun"></i>
            </button>
            <button class="header-btn" id="bg3-btn" title="Bacgraoud na 3">
                <i class="fa-solid fa-circle-half-stroke"></i>
            </button>
            <button class="header-btn" id="user-btn" title="Shiga / Rijista">
                <i class="fa-solid fa-user-plus"></i>
            </button>
            <!-- Add inside your header/navbar section -->
<button class="header-btn" id="install-btn" title="Saita TauraronWasa">
  <i class="fa-solid fa-download fa-bounce"></i>
</button>
<button class="header-btn" id="push1-bell-btn" title="Sanarwa">
  <i class="fa-solid fa-bell"></i>
</button>

<!-- Push notification container (add after header/navbar) -->
<div id="push1-container" class="push1-container">
  <span class="push1-close" id="push1-close-btn">&times;</span>
  <div class="push1-content">
    <i class="fa-solid fa-bell fa-shake"></i>
    <strong>Amince da sanarwa?</strong>
    <div style="margin: 10px 0 16px 0;">
      <button id="push1-allow-btn" class="push1-btn">Kunna</button>
      <button id="push1-deny-btn" class="push1-btn push1-btn-deny">Kashe</button>
    </div>
  </div>
</div>
        </div>
    </div>
    
<div id="push1-modern-alert" class="push1-modern-alert"></div>
    

   
    <div id="register-notification" class="hidden">
        <div class="register-container">
            <button class="close-btn" id="close-register"><i class="fa-solid fa-times"></i></button>
            <p>Domin cigaba da amfani da wasu fasaloli, sai kayi rijista ko shiga:</p>
            <div class="register-actions">
                <a href="register.html" class="register-link">Rijista</a>
                <a href="login.html" class="login-link">Shiga</a>
            </div>
        </div>
    </div>
</header>
<!-- ‚è≥‚úîÔ∏èSite 1 HTML ya kare daga nan -->


<!-- üö¶‚úîÔ∏èSite 2 HTML ya fara daga nan -->
<section id="site2-container">
    <div class="site2-menu">
        <div class="site2-menu-item" id="site2-profile" title="Profile">
            <img src="https://i.imgur.com/4Duz0G5.png" alt="Profile" class="menu-img">
            <span>Profile</span>
        </div>
        <div class="site2-menu-item" id="site2-status" title="Status">
            <a href="statusPost.html" style="text-decoration: none; color: inherit;">
                <div class="site2-view-anim">
                    <i class="fa-solid fa-square-poll-vertical"></i>
                    <span id="view-count"></span>
                </div>
               <center> <span class="site2-viewcount-text">View News History</span></center>
            </a>
        </div>
        <div class="site2-menu-item" id="site2-teams" title="TauraronWasa Teams">
            <img src="https://i.imgur.com/vQmF5sz.png" alt="Teams" class="menu-img">
            <span>Teams</span>
        </div>
    </div>
</section>
<!-- ‚è≥‚úîÔ∏èSite 2 HTML ya kare daga nan -->

    

    <!-- üö¶‚úîÔ∏èSite 3 HTML ya fara daga nan -->
    <section id="site3-leagues">
        <div class="leagues-scroller">
            <div class="league-card" data-link="premier.html">
                <img src="https://i.imgur.com/DZeMJj8.png" alt="Premier League">
                <span>Premier</span>
            </div>
            <div class="league-card" data-link="laliga.html">
                <img src="https://i.imgur.com/tuYj69T.png" alt="Laliga">
                <span>Laliga</span>
            </div>
            <div class="league-card" data-link="champions.html">
                <img src="https://i.imgur.com/Ra2xVMd.png" alt="Champions League">
                <span>Champions</span>
            </div>
            <div class="league-card" data-link="eropa.html">
                <img src="https://i.imgur.com/vBt3j15.png" alt="Eropa League">
                <span>Eropa </span>
            </div>
            <div class="league-card" data-link="fa.html">
                <img src="https://i.imgur.com/WUSKrxL.png" alt="FA Cup">
                <span>FA Cup</span>
            </div>
            <div class="league-card" data-link="siriyaa.html">
                <img src="https://i.imgur.com/2grD9G5.png" alt="Serie A">
                <span>Serie A</span>
            </div>
            <div class="league-card" data-link="bundesliga.html">
                <img src="https://i.imgur.com/LzYuOUD.png" alt="Bundesliga">
                <span>Bundesliga</span>
            </div>
            <div class="league-card" data-link="ligue-1.html">
                <img src="https://i.imgur.com/uzdLchG.png" alt="Ligue 1">
               
                <span>NPFL</span>
            </div>
            <div class="league-card" data-link="search.html">
                <img src="https://i.imgur.com/OtQfYC6.png" alt="All Cups">
                <span>All Cup</span>
            </div>
            <div class="league-card" data-link="Team.html">
                <img src="https://i.imgur.com/CgvdgMA.png" alt="About">
                <span>Teams</span>
            </div>
            <div class="league-card" data-link="contact.html">
                <img src="https://i.imgur.com/gfh6fJW.png" alt="Contact">
                <span>Contact</span>
            </div>
        </div>
    </section>
    <!-- ‚è≥‚úîÔ∏èSite 3 HTML ya kare daga nan -->
    
<!-- üö¶‚úîÔ∏èSite 4 HTML (Injection Point)-->
<section id="site4-sarki"></section>

<div id="sarki-profile-modal" class="sarki-modal" style="display:none;">
    <div class="sarki-modal-overlay"></div>
    <div class="sarki-modal-content">
        <button class="sarki-modal-close" id="sarki-profile-modal-close" aria-label="Rufe" style="color:blue;">x</button>
        <div class="sarki-modal-img-wrapper">
            <img id="sarki-modal-profile-img" class="sarki-modal-profile-img" src="" alt="Babban hoto na Sarki">
            <img id="sarki-modal-club-img" class="sarki-modal-club-img" src="" alt="Logo na Kungiya">
     <span class="sarki-modal-username"  >üèÖSarkin Wannan Mako Na TauraronWasaüôè</span><span class="sarki-modal-usernam2"  id="sarki-modal-username"></span>
        </div>
    </div>
</div>
<!-- ‚è≥‚úîÔ∏èSite 4 HTML ya kare daga nan -->

<!-- ‚è≥‚úîÔ∏èSite 5 HTML ya fara daga nan -->

<section id="site5-kaitsayepost">
    </section>
<div id="site5-push-container" class="site5-push-container" hidden></div>
    <!-- ‚è≥‚úîÔ∏èSite 5 HTML ya kare daga nan -->


    <!-- üö¶‚úîÔ∏èSite 6 HTML ya fara daga nan -->
<section id="site6-wasanninyau"></section>
<!-- Navigation bar for days -->
<nav id="site6-navbar" style="display:none;">
  <button id="site6-prevDay" aria-label="Prev Day" style="background:none;border:none;cursor:pointer;">
    <i class="fa fa-futbol"></i><
  </button>
  <span id="site6-dateDisplay"></span>
  <button id="site6-nextDay" aria-label="Next Day" style="background:none;border:none;cursor:pointer;">
    ‚öΩ>
  </button>
</nav>
<!-- Loader -->
<div id="site6-loader" style="display:none;text-align:center;padding:1.5rem;">
  <i class="fa fa-spinner fa-spin fa-2x"></i>
</div>
<!-- ‚è≥‚úîÔ∏èSite 6 HTML ya kare daga nan -->
    
 <!-- üö¶‚úîÔ∏èSite 7 HTML ya fara daga nan -->
 <section id="site7-wasaninmasuzabi" aria-label="Wasanni Masu Zafi"></section>
<!-- ‚è≥‚úîÔ∏èSite 7 HTML ya kare daga nan -->

     <!-- üö¶‚úîÔ∏èSite 8 HTML ya fara daga nan -->
<section id="site8-posting"></section>
<!-- ‚è≥‚úîÔ∏èSite 8 HTML ya kare daga nan -->

    <!-- Push notification container -->
    <div id="site8-push-container" class="site8-push-container"></div>
       

    <script type="module">¬†¬†¬†¬†¬†¬†¬†¬†¬† 
// üö¶‚úîÔ∏èSite 1 JS ya fara daga nan
import { app, analytics, firebaseConfig } from './firebase.js';

import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";

import { getDatabase, ref, get, set, push, update, remove, child, onValue, runTransaction } 

¬† from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";
// ======== BACGRAOUD SWITCHER (Site 1) =========

const body = document.body;

const bgBtns = [

¬†¬†¬† document.getElementById("bg1-btn"),

¬†¬†¬† document.getElementById("bg2-btn"),

¬†¬†¬† document.getElementById("bg3-btn")

];

let currentBg = localStorage.getItem('tw_bg') || 'bg-1';

body.classList.add(currentBg);

bgBtns.forEach((btn, idx) => {

¬†¬†¬† btn.addEventListener('click', () => {

¬†¬†¬†¬†¬†¬†¬† body.classList.remove("bg-1", "bg-2", "bg-3");

¬†¬†¬†¬†¬†¬†¬† const bg = `bg-${idx+1}`;

¬†¬†¬†¬†¬†¬†¬† body.classList.add(bg);

¬†¬†¬†¬†¬†¬†¬† localStorage.setItem('tw_bg', bg);

¬†¬†¬† });

});
// ======== PUSH REGISTER CONTAINER LOGIC (Site 1) ========

const registerNotif = document.getElementById('register-notification');

const userBtn = document.getElementById('user-btn');

userBtn.addEventListener('click', (e) => {

¬†¬†¬† e.stopPropagation(); // domin kada background ya rufe noti

¬†¬†¬† registerNotif.classList.toggle('show');

});

document.getElementById('close-register').onclick = () => registerNotif.classList.remove('show');
window.addEventListener('click', (e) => {

¬†¬†¬† if (

¬†¬†¬†¬†¬†¬†¬† registerNotif.classList.contains('show') &&

¬†¬†¬†¬†¬†¬†¬† !registerNotif.contains(e.target) &&

¬†¬†¬†¬†¬†¬†¬† e.target !== userBtn &&

¬†¬†¬†¬†¬†¬†¬† !userBtn.contains(e.target)

¬†¬†¬† ) {

¬†¬†¬†¬†¬†¬†¬† registerNotif.classList.remove('show');

¬†¬†¬† }

});
// ======== INSTALL APP (Site 1) ========

let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {

¬†¬†¬† deferredPrompt = e;

¬†¬†¬† document.getElementById('install-btn').style.display = 'inline-block';

});

document.getElementById('install-btn').onclick = (e) => {

¬†¬†¬† e.preventDefault();

¬†¬†¬† if (deferredPrompt) {

¬†¬†¬†¬†¬†¬†¬† deferredPrompt.prompt();

¬†¬†¬†¬†¬†¬†¬† deferredPrompt = null;

¬†¬†¬† }

};
// ======== SITE 2: MENU NAVIGATION ========

const profileBtn = document.getElementById('site2-profile');

if (profileBtn) profileBtn.onclick = () => window.location = 'profile.html';
const teamsBtn = document.getElementById('site2-teams');

if (teamsBtn) teamsBtn.onclick = () => window.location = 'team.html';

const statusBtn = document.getElementById('site2-status');
if (statusBtn) statusBtn.onclick = () => window.location = 'statusPost.html';


// üö¶‚úîÔ∏èSite 1 JS ya kare daga nan

// üö¶‚úîÔ∏èSite 3 JS ya fara daga nan

document.querySelectorAll('.league-card').forEach(card => {

¬†¬†¬† card.addEventListener('click', () => {

¬†¬†¬†¬†¬†¬†¬† window.location = card.dataset.link;

¬†¬†¬† });

});

// üö¶‚úîÔ∏èSite 3 JS ya kare daga nan

function saveAndRender(sectionKey, data, renderFn, parent) {

¬†¬†¬† localStorage.setItem(sectionKey, JSON.stringify(data));
¬†¬†

¬†¬†¬† if (renderFn && parent) {

¬†¬†¬†¬†¬†¬†¬† parent.innerHTML = "";

¬†¬†¬†¬†¬†¬†¬† if (Array.isArray(data)) {

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† data.forEach(item => parent.appendChild(renderFn(item)));

¬†¬†¬†¬†¬†¬†¬† } else if (data) {

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† parent.appendChild(renderFn(data));

¬†¬†¬†¬†¬†¬†¬† }

¬†¬†¬† }

}

function loadFromLocalStorage(sectionKey, renderFn, parent) {

¬†¬†¬† try {

¬†¬†¬†¬†¬†¬†¬† const raw = localStorage.getItem(sectionKey);

¬†¬†¬†¬†¬†¬†¬† if (raw) {

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† const data = JSON.parse(raw);

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† if (renderFn && parent) {

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† parent.innerHTML = "";

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† if (Array.isArray(data)) {
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† data.forEach(item => parent.appendChild(renderFn(item)));

¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† } else if (data) {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† parent.appendChild(renderFn(data));
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† }
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† }
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† return data;
¬†¬†¬†¬†¬†¬†¬† }
¬†¬†¬† } catch (e) {}
¬†¬†¬† return null;
}

function updateLocalStorageIfChanged(key, data) {
¬†¬†¬† const old = localStorage.getItem(key);
¬†¬†¬† const newStr = JSON.stringify(data);
¬†¬†¬† if (old !== newStr) {
¬†¬†¬†¬†¬†¬†¬† localStorage.setItem(key, newStr);
¬†¬†¬†¬†¬†¬†¬† return true;
¬†¬†¬† }
¬†¬†¬† return false;
}
function setLocalValue(key, val) {
¬†¬†¬† localStorage.setItem(key, JSON.stringify(val));
}
function getLocalValue(key) {
¬†¬†¬† try {
¬†¬†¬†¬†¬†¬†¬† return JSON.parse(localStorage.getItem(key));

¬†¬†¬† } catch (e) {
¬†¬†¬†¬†¬†¬†¬† return null;
¬†¬†¬† }
}
// ========== VIEW COUNTER LOGIC (Site 2) with localStorage cache ==============

const db = getDatabase(app);
const viewCountSpan = document.getElementById('view-count');
const viewRef = ref(db, 'userView');
const VIEW_KEY = "tw_userView";
let localView = getLocalValue(VIEW_KEY);
if (localView !== null) {¬†¬†¬† 
¬†¬†¬† // viewCountSpan.textContent = formatNum(localView);
}
get(viewRef).then((snap) => {

¬†¬†¬† if (!snap.exists()) {

¬†¬†¬†¬†¬†¬†¬† set(viewRef, 0);

¬†¬†¬† }

// }).then(updateViewCount);
});
function updateViewCount() {¬†¬† 
}

function animateViewCount(final) {
}
function formatNum(n) {
¬†¬†¬† if (n >= 1e9) return (n/1e9).toFixed(2) + "b";
¬†¬†¬† if (n >= 1e6) return (n/1e6).toFixed(2) + "m";
¬†¬†¬† if (n >= 1e3) return (n/1e3).toFixed(1) + "k";
¬†¬†¬† return n + "";
}

// üö¶‚úîÔ∏èSite 2 and 3 JS ya kare daga nan

// üö¶‚úîÔ∏è Site 4 JS (Modern, Hausa )
const site4 = document.getElementById('site4-sarki');

const sarkiRef = ref(db, "Sarki");
const SARKI_KEY = "tw_sarki";

// Load from cache/localStorage
loadFromLocalStorage(SARKI_KEY, renderSarki, site4);

// Listen to changes in DB
onValue(sarkiRef, (snap) => {
    site4.innerHTML = "";
    if (!snap.exists()) {
        localStorage.removeItem(SARKI_KEY);
        return;
    }

    const data = snap.val();
    if (!data.isActive) return;
    saveAndRender(SARKI_KEY, data, renderSarki, site4);
});

// Helper function don gyara HTML daga XSS
function escapeHTML(str) {
    return String(str).replace(/[&<>"'`=\/]/g, function(s) {
        return ({
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#39;',
            '`': '&#96;',
            '=': '&#61;',
            '/': '&#47;',
        })[s];
    });
}

// Function don nuna sarki
function renderSarki(data) {
    const d = data;
    if (!d) return null;

    // Tab title (sunan sarki a saman container)
    let fullname = d.fullName || "Sarki";
    let tabTitle = `
    <div class="sarki-tab-container">
      <div class="sarki-tab-title tab1">
        üî• Sarkin Wannan Mako <span class="sarki-tab-name">${escapeHTML(fullname)}</span>
      </div>
    </div>
  `;

    // Fallback BG idan babu image
    let hasBG = !!d.banaimageSarkiLink && d.banaimageSarkiLink !== "";
    let bg = hasBG ?
        `<img src="${d.banaimageSarkiLink}" class="sarki-bg" alt="sarki-bg" onerror="this.style.display='none'">` :
        `<div class="sarki-bg-fallback"><span>
           <img src="https://i.imgur.com/wFVp0uj.png" class="sarkiIm">
        </span></div>`;

    // Score/Logo logic: nuna logo da sunan ∆ôungiya
    let scoreRow = `
      <div class="sarki-score-row">
       <p> <img src="${d.team1Logo}" class="sarki-score-logo" alt="game1logo">
        <span class="sarki-score-team">${d.team1Name || ""}</span></p><p>
        <span>VS</span></p><p>
        <img src="${d.team2Logo}" class="sarki-score-logo" alt="game2logo">
        <span class="sarki-score-team">${d.team2Name || ""}</span><p>
        
      </div>
    `;
   
    const COMMENT_CHAR_LIMIT = 72; 
    let commentHTML = "";
    if (d.commentText && d.commentText.length > 0) {
        let fullText = escapeHTML(d.commentText);
        let displayableText = fullText;
        let readMoreBtn = "";

        if (fullText.length > COMMENT_CHAR_LIMIT) {
            displayableText = fullText.substring(0, COMMENT_CHAR_LIMIT) + '...';
            readMoreBtn = `<span class="read-more-btn">Kara Karantawa</span>`;
        }

        commentHTML = `
        <div class="sarki-comment">
          <p class="comment-text">${displayableText}</p>
          ${readMoreBtn}
          <p class="full-comment-text" style="display:none;">${fullText}</p>
        </div>
      `;
    }

    // Lokaci
    let timeTxt = "";
    if (d.commentTime) {
        let t = new Date(d.commentTime);
        if (!isNaN(t.getTime())) {
            let dstr = `${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear()} ${t.getHours()%12||12}:${t.getMinutes().toString().padStart(2,"0")} ${t.getHours()<12?"AM":"PM"}`;
            timeTxt = dstr;
        }
    }
  
    let audioRow = "";
    if (d.audioLink) {
        audioRow = `
        <div class="sarki-audio-row">
          <img src="${d.profileLogo||'./profile.png'}" class="sarki-audio-profile" alt="profile">
          <audio class="sarki-audio-player" controls preload="none" id="sarki-audio-player">
            <source src="${d.audioLink}">
            Na'am, ba za'a iya kunna sauti ba.
          </audio>
          <img src="${d.teamLogo||'./club.png'}" class="sarki-audio-clublogo" alt="club">
        </div>
      `;
    }

    // Like button state
    let loved = localStorage.getItem("sarki-loved");
    let loveCountVal = Number(d.sarkiLove);
    if (!loveCountVal || loveCountVal < 100) loveCountVal = 100;

    // Profile image & club logo logic
    let profileImage = d.profileLogo || "./profile.png";
    let teamLogo = d.teamLogo || "./club.png";

    // HTML
    let c = document.createElement('div');
    c.style.position = "relative";
    c.innerHTML = `
      ${tabTitle}
      <div class="sarki-container">
        ${bg}
        <div class="sarki-overlay">
          <div class="sarki-top">
            <div class="sarki-info">
              <div class="sarki-fullname">${escapeHTML(fullname)}</div>
              <div class="sarki-congrats">${d.congratsMessage || "Murna da nasara!"}</div>
              ${scoreRow}
              ${commentHTML}
              ${audioRow}
              <div class="sarki-time">Lokacin Nasara: ${timeTxt || ""}</div>
            </div>
            <div class="sarki-profile">
              <img src="${profileImage}" class="sarki-profile-img" alt="Hoto na Sarki" id="sarki-profile-img">
              <img src="${teamLogo}" class="sarki-club-img" alt="Logo na Kungiya">
              <div class="sarki-user-info">
                <img src="${profileImage}" class="sarki-user-profile-logo" alt="logo"/>
                <span class="sarki-username">${escapeHTML(fullname)}</span>
              </div>
            </div>
          </div>
          <div class="sarki-bottom">
            <button class="sarki-love-btn${loved ? " loved" : ""}" id="sarki-love-btn" ${loved ? "disabled" : ""} title="So">
              <i class="fa-solid fa-heart"></i>
            </button>
            <span class="sarki-love-count" id="sarki-love-count">${sarkiFormatNum(loveCountVal)}</span>
          </div>
        </div>
      </div>
    `;

    // Comment Read More logic
    const readMoreBtn = c.querySelector('.read-more-btn');
    if (readMoreBtn) {
        const commentTextEl = c.querySelector('.comment-text');
        const fullCommentTextEl = c.querySelector('.full-comment-text');
        readMoreBtn.onclick = () => {
            commentTextEl.textContent = fullCommentTextEl.textContent;
            readMoreBtn.style.display = 'none';
        };
    }

    // Like handling: only 1 per user, updates DB and UI, shows ‚úîÔ∏è
    let btn = c.querySelector('#sarki-love-btn');
    let likeLock = false;
    if (btn && !loved) {
        btn.onclick = () => {
            if (likeLock) return;
            likeLock = true;
            let loveRef = ref(db, "Sarki/sarkiLove");
            get(loveRef).then(snap => {
                let val = snap.exists() ? Number(snap.val()) : 100;
                if (!val || val < 100) val = 100;
                let el = c.querySelector('#sarki-love-count');
                if (el) el.textContent = sarkiFormatNum(val + 1);
                set(loveRef, val + 1).then(() => {
                    localStorage.setItem("sarki-loved", "1");
                    btn.classList.add("loved");
                    btn.disabled = true;
                });
            }).finally(() => {
                likeLock = false;
            });
        };
    }

    // Dynamic update na like count
    onValue(ref(db, "Sarki/sarkiLove"), (snap) => {
        let el = c.querySelector('#sarki-love-count');
        if (snap.exists() && el) {
            let v = Number(snap.val());
            if (!v || v < 100) v = 100;
            el.textContent = sarkiFormatNum(v);
        }
    });

    // Profile image modal push
    setTimeout(() => {
        const imgBtn = c.querySelector('#sarki-profile-img');
        if (imgBtn) {
            imgBtn.onclick = function() {
                showSarkiProfileModal(profileImage, teamLogo);
            };
        }
    }, 10);

    // Audio auto play/stop logic
    setTimeout(() => {
        const audio = c.querySelector('#sarki-audio-player');
        if (!audio) return;
        let userPlayed = false;
        // Play when container is in viewport, pause when out, unless user clicked play/pause
        const handleAudioAuto = () => {
            const rect = c.getBoundingClientRect();
            const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
            if (isVisible && !userPlayed) {
                if (audio.paused) {
                    audio.play().catch(()=>{});
                }
            } else if (!isVisible && !audio.paused && !userPlayed) {
                audio.pause();
            }
        };
        // Only auto-play/pause if user hasn't interacted
        audio.onplay = () => {
            userPlayed = true;
        };
        audio.onpause = () => { /* no-op */ };
        window.addEventListener('scroll', handleAudioAuto);
        // Auto stop when audio ends
        audio.onended = () => {
            userPlayed = false;
        };
        // Initial check
        handleAudioAuto();
    }, 50);

    return c;
}

// Modal push logic for profile preview
function showSarkiProfileModal(profileImg, clubLogo) {
    const modal = document.getElementById('sarki-profile-modal');
    const img = document.getElementById('sarki-modal-profile-img');
    const club = document.getElementById('sarki-modal-club-img');
    const userName = document.getElementById('sarki-modal-username');
    
    if (!modal || !img || !club || !userName) return;
    img.src = profileImg || "";
    club.src = clubLogo || "";
    // User name a modal
    const sarkiName = document.querySelector('.sarki-fullname');
    userName.textContent = sarkiName ? sarkiName.textContent : 'Sarki';

    modal.classList.add('show');
    modal.style.display = "flex";
}

function hideSarkiProfileModal() {
    const modal = document.getElementById('sarki-profile-modal');
    if (modal) {
        modal.classList.remove('show');
        modal.style.display = "none";
    }
}

document.getElementById('sarki-profile-modal-close').onclick = hideSarkiProfileModal;
document.querySelector('#sarki-profile-modal .sarki-modal-overlay').onclick = hideSarkiProfileModal;

// Format number for sarki site (starts at 100, shows k after 999)
function sarkiFormatNum(n) {
    n = Number(n) || 100;
    if (n < 1000) return n.toString();
    if (n < 1e6) return (n / 1e3).toFixed(n % 1000 === 0 ? 0 : 1).replace(/\.0$/, '') + 'k';
    if (n < 1e9) return (n / 1e6).toFixed(n % 1e6 === 0 ? 0 : 1).replace(/\.0$/, '') + 'm';
    return (n / 1e9).toFixed(n % 1e9 === 0 ? 0 : 1).replace(/\.0$/, '') + 'b';
}

//üö¶‚úîÔ∏èSite 4 anan ya kare


// ‚úçÔ∏è‚òÄÔ∏è SITE5 MODERN FIXED JS (KaiTsaye + post)

// ==== PUSH NOTIFICATION CONTAINER (MODERN) ====
function showSite5Push(msg, icon = "fa-circle-check", timeout = 2600) {
    const c = document.getElementById('site5-push-container');
    if (!c) {
        console.warn("site5-push-container element not found. Displaying alert instead.");
        return alert(msg);
    }
    c.innerHTML = `<i class="fa-solid ${icon}" style="color:#ffcb05;"></i> <span>${msg}</span>`;
    c.hidden = false;
    c.classList.add('show');
    setTimeout(() => {
        c.classList.remove('show');
        c.hidden = true;
    }, timeout);
}

// ==== DOM ELEMENTS ====
const site5 = document.getElementById('site5-kaitsayepost');
const kaitsayeRef = ref(db, "KaiTsayePost");
const KAITSAYE_KEY = "tw_kaitsaye_modern";
let currentPlayingAudio = null;
let currentRediyoAudio = null;
let mediaSessionInitialized = false;
let lastFetchedPostId = null;

// ==== UTILS ====
function formatCount(num) {
    if (num == null) return 0;
    if (num >= 1e6) return (num / 1e6).toFixed(1).replace(/\.0$/, "") + "m";
    if (num >= 1e3) return (num / 1e3).toFixed(1).replace(/\.0$/, "") + "k";
    return num;
}

function getYouTubeVideoId(url) {
    let videoId = null;
    const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i;
    const match = url.match(regex);
    if (match && match[1]) {
        videoId = match[1];
    }
    return videoId;
}

function formatTime(t) {
    t = Math.floor(t);
    return `${Math.floor(t / 60)}:${(t % 60).toString().padStart(2, '0')}`;
}

// ==== SHOW LOADING & EMPTY STATE ====
function showKaitsayeLoading() {
    site5.innerHTML = `<div class="kaitsaye-post-container" style="min-height:100%;display:flex;justify-content:center;align-items:center;">
        <div style="text-align:center;width:100%;">
            <i class="fa-solid fa-spinner fa-spin" style="font-size:2.5rem;color:#ffcb05;margin-bottom:0.6rem;"></i>
            <div style="font-weight:700;color:#fde000;font-size:1.12rem;">Ana lodawa...</div>
        </div>
    </div>`;
}

function showKaitsayeEmptyState() {
    site5.innerHTML = `<div class="kaitsaye-post-container" style="min-height:100%;display:flex;justify-content:center;align-items:center;">
        <div style="text-align:center;width:100%;">
            <i class="fa-solid fa-box-open" style="font-size:2.5rem;color:#ffcb05;margin-bottom:0.6rem;"></i>
            <div style="font-weight:700;color:#fde000;font-size:1.12rem;">Babu wani sabon post a halin yanzu.</div>
        </div>
    </div>`;
}

// ==== MAIN FUNCTION TO LISTEN FOR FIREBASE CHANGES ====
function initializeKaitsayePostListener() {
    onValue(kaitsayeRef, (snap) => {
        let postFromFirebase = null;
        if (snap.exists()) {
            postFromFirebase = snap.val();
        }
        if (!postFromFirebase || !postFromFirebase.postid || (!postFromFirebase.text && !postFromFirebase.photoLink && !postFromFirebase.videoLink && !postFromFirebase.audioPostLink && !postFromFirebase.rediyoKaiTsayeAudioLink && !postFromFirebase.onlineLink1)) {
            site5.innerHTML = "";
            clearAllPostSpecificLocalStorage();
            lastFetchedPostId = null;
            showKaitsayeEmptyState();
            return;
        }
        const currentPostId = postFromFirebase.postid;
        if (currentPostId !== lastFetchedPostId) {
            console.log("An gano sabon post ko farkon lodi. ID:", currentPostId);
            if (lastFetchedPostId !== null) {
                const oldViewKey = `kaitsaye-view-${lastFetchedPostId}`;
                const oldLovedKey = `site5-loved-${lastFetchedPostId}`;
                const oldAudioKey = `audio-position-${lastFetchedPostId}`;
                localStorage.removeItem(oldViewKey);
                localStorage.removeItem(oldLovedKey);
                localStorage.removeItem(oldAudioKey);
            }
            if (lastFetchedPostId !== null) {
                pushNewPostNotification(postFromFirebase);
            }
            lastFetchedPostId = currentPostId;
        }
        postFromFirebase.see = postFromFirebase.see || 0;
        postFromFirebase.love = postFromFirebase.love || 0;
        postFromFirebase.commentCount = postFromFirebase.totalComment || 0;
        renderAndCachePost(postFromFirebase);
    });
}

function pushNewPostNotification(p) {
    if (!p.rediyoKaiTsayeAudioLink) {
        showSite5Push("An samu sabon post!", "fa-circle-check", 2600);
    }
}

function renderAndCachePost(p) {
    if (p && (p.text || p.photoLink || p.videoLink || p.audioPostLink || p.rediyoKaiTsayeAudioLink || p.onlineLink1)) {
        site5.innerHTML = "";
        site5.appendChild(renderKaitsayePost(p));
    } else {
        site5.innerHTML = "";
        showKaitsayeEmptyState();
    }
}

function clearAllPostSpecificLocalStorage() {
    const keysToRemove = [];
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('kaitsaye-view-') || key.startsWith('site5-loved-') || key.startsWith('audio-position-')) {
            keysToRemove.push(key);
        }
    }
    keysToRemove.forEach(key => localStorage.removeItem(key));
    console.log("An goge duk wani bayani na post daga localStorage.");
}

// ==== RENDER SINGLE POST ====
function renderKaitsayePost(p) {
    const posttime = p.posttime ? new Date(p.posttime).toLocaleString('ha-NG', { hour12: true }) : "";
    const topBar = `<div class="kaitsaye-top-bar">
        <img src="https://i.imgur.com/CgvdgMA.png" alt="logo" class="kaitsaye-top-bar-logo">
        <div class="kaitsaye-top-title">KaiTsaye</div>
        <div class="kaitsaye-top-bar-time"><i class="fa-regular fa-clock"></i> <span>${posttime}</span></div>
    </div>`;

    let text = "";
    if (p.text && typeof p.text === "string" && p.text.trim().length) {
        text = `<div class="kaitsaye-post-text" style="white-space: pre-wrap;">${p.text}</div>`;
    }

    let gameButtonsHtml = "";
    const daysOfWeek = ['Lahadi', 'Litinin', 'Talata', 'Laraba', 'Alhamis', 'Juma\'a', 'Asabar'];
    for (let i = 1; i <= 3; ++i) {
        const onlineLink = p[`onlineLink${i}`];
        const logo1 = p[`onlineLink1LogoLink${(i * 2) - 1}`];
        const team1 = p[`sunanKungiya${(i * 2) - 1}`];
        const logo2 = p[`onlineLink1LogoLink${(i * 2)}`];
        const team2 = p[`sunanKungiya${(i * 2)}`];
        const timeZaA_FaraWasa = p[`timeDaZaaFaraWasa${(i * 2) - 1}`];
        if (onlineLink && (logo1 || team1 || logo2 || team2 || timeZaA_FaraWasa)) {
            let gameTimeFormatted = '';
            if (timeZaA_FaraWasa) {
                const gameDate = new Date(timeZaA_FaraWasa);
                if (!isNaN(gameDate.getTime())) {
                    const dayName = daysOfWeek[gameDate.getDay()];
                    const day = gameDate.getDate();
                    const month = gameDate.toLocaleString('ha-NG', { month: 'long' });
                    const year = gameDate.getFullYear();
                    const time = gameDate.toLocaleTimeString('ha-NG', { hour: '2-digit', minute: '2-digit', hour12: true });
                    gameTimeFormatted = `${dayName} ${day} ${month} ${year} ${time}`;
                }
            }
            gameButtonsHtml += `<button class="kaitsaye-game-match-btn" onclick="window.open('${onlineLink}','_blank')">
                <div class="team-info">
                    ${logo1 ? `<img src="${logo1}" alt="Logo Team 1" class="team-logo">` : ''}
                    <span>${team1 || 'Kungiya 1'}</span>
                </div>
                <span class="vs-text">VS</span>
                <div class="team-info">
                    ${logo2 ? `<img src="${logo2}" alt="Logo Team 2" class="team-logo">` : ''}
                    <span>${team2 || 'Kungiya 2'}</span>
                </div>
                <div class="game-time-display">${gameTimeFormatted || ''}</div>
            </button>`;
        }
    }
    let gameLinksSection = "";
    if (gameButtonsHtml) {
        gameLinksSection = `<div class="kaitsaye-game-matches">${gameButtonsHtml}</div>`;
    }

    let media = "";
    if (p.rediyoKaiTsayeAudioLink && typeof p.rediyoKaiTsayeAudioLink === "string" && p.rediyoKaiTsayeAudioLink.trim().length) {
        const hasImage = p.photoLink && typeof p.photoLink === "string" && p.photoLink.trim().length;
        media = `<div class="rediyo-kai-tsaye-player ${hasImage ? 'has-image' : ''}" data-audio="${p.rediyoKaiTsayeAudioLink}" data-postid="${p.postid}">
            ${hasImage ? `<img src="${p.photoLink}" alt="Radio Background" class="rediyo-background-image">` : ''}
            <div class="rediyo-kai-tsaye-overlay">
                <div class="rediyo-kai-tsaye-controls ${hasImage ? 'center-overlay' : ''}">
                    <button class="rediyo-kai-tsaye-button" title="Kunna Rediyo">
                        <i class="fa-solid fa-play"></i>
                    </button>
                    ${!hasImage ? `<div class="rediyo-kai-tsaye-title">Kai Tsaye Rediyo</div>` : ''}
                </div>
            </div>
        </div>`;
    } else if (p.videoLink && typeof p.videoLink === "string" && p.videoLink.trim().length) {
        let videoId = getYouTubeVideoId(p.videoLink);
        if (videoId) {
            media = `<div class="kaitsaye-video-container" data-youtube-id="${videoId}">
                <img src="https://i.ytimg.com/vi/${videoId}/hqdefault.jpg" alt="Video Thumbnail" class="video-thumbnail">
                <div class="video-overlay">
                    <i class="fa-solid fa-play video-play-btn" title="Kunna bidiyo"></i>
                    <button class="video-fullscreen-btn" title="Cikakken allo"><i class="fa-regular fa-square"></i></button>
                </div>
            </div>`;
        } else {
            media = `<div class="kaitsaye-video-container">
                <video class="site5-kaitsaye-video" src="${p.videoLink}" playsinline></video>
                <div class="video-overlay">
                    <i class="fa-solid fa-play video-play-btn" title="Kunna bidiyo"></i>
                    <button class="video-fullscreen-btn" data-videourl="${p.videoLink}" title="Cikakken allo"><i class="fa-regular fa-square"></i></button>
                </div>
            </div>`;
        }
    } else if (p.audioPostLink && typeof p.audioPostLink === "string" && p.audioPostLink.trim().length) {
        const hasPhoto = p.photoLink && p.photoLink.trim().length;
        let audioPlayerHtml = `<div class="kaitsaye-audio-player-controls">
                <button class="audio-play-btn" title="Kunne"><i class="fa-solid fa-play"></i></button>
                <div class="audio-progress-container">
                    <div class="audio-progress-bar"></div>
                    <input type="range" class="audio-seek-slider" value="0" min="0" max="100" step="0.1">
                </div>
                <span class="audio-time">0:00</span>
            </div>`;
        if (hasPhoto) {
            media = `<div class="kaitsaye-audio-player-with-image" data-audio="${p.audioPostLink}" data-postid="${p.postid}">
                <img src="${p.photoLink}" alt="Audio Post Image" class="kaitsaye-audio-image">
                <div class="kaitsaye-audio-player-overlay">
                    ${audioPlayerHtml}
                </div>
            </div>`;
        } else {
            media = `<div class="kaitsaye-audio-player-box" data-audio="${p.audioPostLink}" data-postid="${p.postid}">
                ${audioPlayerHtml}
            </div>`;
        }
    } else if (p.photoLink && typeof p.photoLink === "string" && p.photoLink.trim().length) {
        media = `<img src="${p.photoLink}" alt="post-image" class="site5-kaitsaye-image">`;
    }

    let mediaBox = "";
    if (media) {
        mediaBox = `<div class="kaitsaye-post-media-box">${media}</div>`;
    }

    const actionsBar = `<div class="kaitsaye-actions-bar">
        <button class="kaitsaye-action-btn view" title="See"><i class="fa-regular fa-eye"></i> <span class="kaitsaye-action-badge">${formatCount(p.see || 0)}</span></button>
        <button class="kaitsaye-action-btn comment" title="Comment"><i class="fa-regular fa-comment"></i> <span class="kaitsaye-action-badge">${formatCount(p.totalComment || 0)}</span></button>
        <button class="kaitsaye-action-btn love${localStorage.getItem(`site5-loved-${p.postid}`) === "true" ? " active" : ""}" title="Like/Love"><i class="fa-solid fa-heart"></i> <span class="kaitsaye-action-badge">${formatCount(p.love || 0)}</span></button>
    </div>`;

    let contentArr = [];
    if (text) contentArr.push(text);
    if (gameLinksSection) contentArr.push(gameLinksSection);
    if (mediaBox) contentArr.push(mediaBox);

    const c = document.createElement('div');
    c.className = "kaitsaye-post-container";
    c.setAttribute('data-postid', p.postid);
    c.innerHTML = `${topBar}<div class="kaitsaye-content">${contentArr.join("")}</div>${actionsBar}`;

    setTimeout(() => {
        if (p.rediyoKaiTsayeAudioLink) {
            setupRediyoPlayer(c, p.rediyoKaiTsayeAudioLink, p.postid);
        } else if (p.audioPostLink) {
            setupAudioPlayer(c, p.postid);
        }
        setupVideoPlayers(c);
        setupKaitsayeActions(c, p);
        setupKaitsayeIntersection(c, p);
    }, 40);

    return c;
}

// ==== FUNCTIONS FOR VIDEO HANDLING ====
let kaitsayeVideoFullscreenViewer = null;

function setupVideoPlayers(container) {
    const videoContainer = container.querySelector('.kaitsaye-video-container');
    if (!videoContainer) return;
    const videoId = videoContainer.dataset.youtubeId;
    const nativeVideo = videoContainer.querySelector('video');
    const thumbnail = videoContainer.querySelector('.video-thumbnail');
    const playBtn = videoContainer.querySelector('.video-play-btn');
    const fullscreenBtn = videoContainer.querySelector('.video-fullscreen-btn');
    const videoOverlay = videoContainer.querySelector('.video-overlay');

    if (videoId) {
        const loadAndPlayYouTube = () => {
            loadYouTubeIframe(videoContainer, videoId);
        };
        if (playBtn) {
            playBtn.onclick = loadAndPlayYouTube;
        }
        if (thumbnail) {
            thumbnail.onclick = loadAndPlayYouTube;
        }
        if (fullscreenBtn) {
            fullscreenBtn.onclick = () => {
                const videoSrc = `https://www.youtube.com/embed/${videoId}?autoplay=1&fs=1&modestbranding=1&playsinline=1&color=white`;
                handleKaitsayeVideoFullscreen(videoSrc, true);
            };
        }
    } else if (nativeVideo) {
        setupVideoAutoPlay(container);
        const toggleNativeVideoPlay = () => {
            handleKaitsayeVideoPlay(nativeVideo, playBtn);
        };
        if (playBtn) {
            playBtn.onclick = toggleNativeVideoPlay;
        }
        if (fullscreenBtn) {
            fullscreenBtn.onclick = () => {
                handleKaitsayeVideoFullscreen(nativeVideo.src, false);
            };
        }
        nativeVideo.onclick = toggleNativeVideoPlay;
        nativeVideo.onplay = () => {
            if (playBtn) playBtn.classList.add('playing');
            if (videoOverlay) videoOverlay.style.display = 'none';
        };
        nativeVideo.onpause = () => {
            if (playBtn) playBtn.classList.remove('playing');
            if (videoOverlay) videoOverlay.style.display = 'flex';
        };
    }
}

function loadYouTubeIframe(videoContainer, videoId) {
    if (videoContainer.querySelector('iframe.site5-kaitsaye-video')) {
        return;
    }
    const thumbnail = videoContainer.querySelector('.video-thumbnail');
    const videoOverlay = videoContainer.querySelector('.video-overlay');
    if (thumbnail) thumbnail.style.display = 'none';
    if (videoOverlay) videoOverlay.style.display = 'none';
    const iframe = document.createElement('iframe');
    iframe.className = 'site5-kaitsaye-video';
    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&fs=1&modestbranding=1&playsinline=1&color=white`;
    iframe.setAttribute('frameborder', '0');
    iframe.setAttribute('allowfullscreen', 'true');
    iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen');
    while (videoContainer.firstChild) {
        videoContainer.removeChild(videoContainer.firstChild);
    }
    videoContainer.appendChild(iframe);
}

function handleKaitsayeVideoPlay(videoElement, playBtn) {
    if (videoElement.paused) {
        videoElement.play().catch(e => console.error("Video play error:", e));
    } else {
        videoElement.pause();
    }
}

function handleKaitsayeVideoFullscreen(videoSrc, isYouTube) {
    if (!kaitsayeVideoFullscreenViewer) {
        kaitsayeVideoFullscreenViewer = document.createElement('div');
        kaitsayeVideoFullscreenViewer.className = 'kaitsaye-video-fullscreen-viewer';
        document.body.appendChild(kaitsayeVideoFullscreenViewer);
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                kaitsayeVideoFullscreenViewer.classList.remove('active');
                kaitsayeVideoFullscreenViewer.innerHTML = '';
                document.body.style.overflow = '';
            }
        });
    }
    let mediaElement;
    if (isYouTube) {
        const iframe = document.createElement('iframe');
        iframe.className = 'kaitsaye-fullscreen-video-frame';
        iframe.src = videoSrc;
        iframe.setAttribute('frameborder', '0');
        iframe.setAttribute('allowfullscreen', 'true');
        iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen');
        mediaElement = iframe;
    } else {
        const video = document.createElement('video');
        video.className = 'kaitsaye-fullscreen-video-frame';
        video.src = videoSrc;
        video.setAttribute('controls', 'true');
        video.setAttribute('playsinline', 'true');
        mediaElement = video;
    }
    const closeBtn = document.createElement('button');
    closeBtn.className = 'kaitsaye-video-fullscreen-close-btn';
    closeBtn.innerHTML = '<i class="fa-solid fa-xmark"></i>';
    closeBtn.onclick = function() {
        if (document.fullscreenElement) {
            document.exitFullscreen();
        } else {
            kaitsayeVideoFullscreenViewer.classList.remove('active');
            document.body.style.overflow = '';
            kaitsayeVideoFullscreenViewer.innerHTML = '';
        }
    };
    kaitsayeVideoFullscreenViewer.innerHTML = '';
    kaitsayeVideoFullscreenViewer.appendChild(closeBtn);
    kaitsayeVideoFullscreenViewer.appendChild(mediaElement);
    kaitsayeVideoFullscreenViewer.classList.add('active');
    document.body.style.overflow = 'hidden';
    if (kaitsayeVideoFullscreenViewer.requestFullscreen) {
        kaitsayeVideoFullscreenViewer.requestFullscreen().catch(err => {
            console.log(`Error attempting to enable fullscreen: ${err.message} (${err.name})`);
        });
    }
    if (!isYouTube) {
        mediaElement.play().catch(e => console.error("Fullscreen video play error:", e));
    }
}

// ==== AUDIO PLAYER (for audioPostLink) ====
function setupAudioPlayer(container, postId) {
    const box = container.querySelector('.kaitsaye-audio-player-box') || container.querySelector('.kaitsaye-audio-player-with-image');
    if (!box) return;
    const btn = box.querySelector('.audio-play-btn');
    const audioUrl = box.getAttribute('data-audio');
    const seekSlider = box.querySelector('.audio-seek-slider');
    const timeEl = box.querySelector('.audio-time');
    const audio = new Audio(audioUrl);
    const LOCALSTORAGE_AUDIO_POSITION_KEY = `audio-position-${postId}`;

    const savedTime = localStorage.getItem(LOCALSTORAGE_AUDIO_POSITION_KEY);
    if (savedTime) {
        audio.currentTime = parseFloat(savedTime);
    }
    
    window.addEventListener('clear-storage', (e) => {
        if (e.detail.postId === postId) {
            audio.pause();
            audio.currentTime = 0;
            btn.innerHTML = '<i class="fa-solid fa-play"></i>';
        }
    });

    audio.onended = () => {
        btn.innerHTML = '<i class="fa-solid fa-play"></i>';
        if (seekSlider) seekSlider.value = 0;
        localStorage.removeItem(LOCALSTORAGE_AUDIO_POSITION_KEY);
        currentPlayingAudio = null;
        if ((!currentRediyoAudio || currentRediyoAudio.paused) && 'mediaSession' in navigator) {
            navigator.mediaSession.metadata = null;
            navigator.mediaSession.playbackState = 'none';
        }
    };
    audio.ontimeupdate = () => {
        if (seekSlider) {
            seekSlider.value = (audio.currentTime / audio.duration) * 100 || 0;
            localStorage.setItem(LOCALSTORAGE_AUDIO_POSITION_KEY, audio.currentTime.toString());
        }
        if (timeEl) timeEl.textContent = formatTime(audio.currentTime);
    };
    audio.onloadedmetadata = () => {
        if (timeEl) timeEl.textContent = formatTime(audio.duration);
    };
    if (seekSlider) {
        seekSlider.oninput = () => {
            audio.currentTime = (parseFloat(seekSlider.value) / 100) * audio.duration;
        };
    }
    btn.onclick = () => {
        if (currentRediyoAudio && !currentRediyoAudio.paused) {
            currentRediyoAudio.pause();
            const rediyoPlayerElement = document.querySelector(`.rediyo-kai-tsaye-player[data-postid="${currentRediyoAudio.dataset.postid}"]`);
            if (rediyoPlayerElement) {
                const rediyoBtn = rediyoPlayerElement.querySelector('.rediyo-kai-tsaye-button');
                if (rediyoBtn) rediyoBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
            }
        }
        if (currentPlayingAudio && currentPlayingAudio !== audio) {
            currentPlayingAudio.pause();
            const prevBtn = currentPlayingAudio.parentElement.querySelector('.audio-play-btn');
            if (prevBtn) prevBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
        }
        if (audio.paused) {
            audio.play().then(() => {
                btn.innerHTML = '<i class="fa-solid fa-pause"></i>';
                currentPlayingAudio = audio;
                updateMediaSession(audio, "Audio Post", postId);
            }).catch(e => console.error("Audio play error:", e));
        } else {
            audio.pause();
            btn.innerHTML = '<i class="fa-solid fa-play"></i>';
            currentPlayingAudio = null;
            if ((!currentRediyoAudio || currentRediyoAudio.paused) && 'mediaSession' in navigator) {
                navigator.mediaSession.metadata = null;
                navigator.mediaSession.playbackState = 'none';
            }
        }
    };
    audio.preload = "auto";
    const audioObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                if (audio.paused && !currentPlayingAudio && (!currentRediyoAudio || currentRediyoAudio.paused)) {
                    audio.play().then(() => {
                        btn.innerHTML = '<i class="fa-solid fa-pause"></i>';
                        currentPlayingAudio = audio;
                        updateMediaSession(audio, "Audio Post", postId);
                    }).catch(e => console.error("Audio autoplay failed:", e));
                }
            } else {
                if (!audio.paused && currentPlayingAudio === audio) {
                    audio.pause();
                    btn.innerHTML = '<i class="fa-solid fa-play"></i>';
                    currentPlayingAudio = null;
                    if ((!currentRediyoAudio || currentRediyoAudio.paused) && 'mediaSession' in navigator) {
                        navigator.mediaSession.metadata = null;
                        navigator.mediaSession.playbackState = 'none';
                    }
                }
            }
        });
    }, {
        threshold: 0.8
    });
    audioObserver.observe(box);
    if (audio.readyState >= 2) {
        if (timeEl) timeEl.textContent = formatTime(audio.duration);
    }
}

// ==== REDIYO KAI TSAYE PLAYER ====
function setupRediyoPlayer(container, audioLink, postId) {
    const rediyoPlayer = container.querySelector('.rediyo-kai-tsaye-player');
    const rediyoButton = rediyoPlayer ? rediyoPlayer.querySelector('.rediyo-kai-tsaye-button') : null;
    if (!rediyoPlayer || !rediyoButton || !audioLink) return;
    const rediyoAudio = new Audio(audioLink);
    rediyoAudio.loop = true;
    rediyoAudio.preload = "auto";
    rediyoAudio.dataset.postid = postId;
    if (currentRediyoAudio === rediyoAudio && !rediyoAudio.paused) {
        rediyoButton.innerHTML = '<i class="fa-solid fa-pause"></i>';
    } else {
        rediyoButton.innerHTML = '<i class="fa-solid fa-play"></i>';
    }
    rediyoButton.onclick = () => {
        if (currentPlayingAudio && !currentPlayingAudio.paused) {
            currentPlayingAudio.pause();
            const prevBtn = currentPlayingAudio.parentElement.querySelector('.audio-play-btn');
            if (prevBtn) prevBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
            currentPlayingAudio = null;
        }
        if (currentRediyoAudio && currentRediyoAudio !== rediyoAudio && !currentRediyoAudio.paused) {
            currentRediyoAudio.pause();
            const prevRediyoPlayer = document.querySelector(`.rediyo-kai-tsaye-player[data-postid="${currentRediyoAudio.dataset.postid}"]`);
            if (prevRediyoPlayer) {
                const prevRediyoBtn = prevRediyoPlayer.querySelector('.rediyo-kai-tsaye-button');
                if (prevRediyoBtn) prevRediyoBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
            }
        }
        if (rediyoAudio.paused) {
            rediyoAudio.play().then(() => {
                rediyoButton.innerHTML = '<i class="fa-solid fa-pause"></i>';
                currentRediyoAudio = rediyoAudio;
                updateMediaSession(rediyoAudio, "Kai Tsaye Rediyo", postId);
            }).catch(e => console.error("Rediyo autoplay failed:", e));
        } else {
            rediyoAudio.pause();
            rediyoButton.innerHTML = '<i class="fa-solid fa-play"></i>';
            currentRediyoAudio = null;
            if ((!currentPlayingAudio || currentPlayingAudio.paused) && 'mediaSession' in navigator) {
                navigator.mediaSession.metadata = null;
                navigator.mediaSession.playbackState = 'none';
            }
        }
    };
    const rediyoObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                if (rediyoAudio.paused && !currentPlayingAudio && (!currentRediyoAudio || currentRediyoAudio === rediyoAudio)) {
                    rediyoAudio.play().then(() => {
                        rediyoButton.innerHTML = '<i class="fa-solid fa-pause"></i>';
                        currentRediyoAudio = rediyoAudio;
                        updateMediaSession(rediyoAudio, "Kai Tsaye Rediyo", postId);
                    }).catch(e => console.error("Rediyo autoplay failed on intersection:", e));
                }
            } else {
                if (!rediyoAudio.paused && currentRediyoAudio === rediyoAudio) {
                    rediyoAudio.pause();
                    rediyoButton.innerHTML = '<i class="fa-solid fa-play"></i>';
                    currentRediyoAudio = null;
                    if ((!currentPlayingAudio || currentPlayingAudio.paused) && 'mediaSession' in navigator) {
                        navigator.mediaSession.metadata = null;
                        navigator.mediaSession.playbackState = 'none';
                    }
                }
            }
        });
    }, {
        threshold: 0.7
    });
    rediyoObserver.observe(rediyoPlayer);
}

// ==== NEW: MEDIA SESSION API HANDLING ====
function updateMediaSession(audioElement, title, postId) {
    if ('mediaSession' in navigator) {
        navigator.mediaSession.metadata = new MediaMetadata({
            title: title,
            artist: 'Kai Tsaye‚è∏Ô∏è',
            album: 'Live Stream‚óÄÔ∏è',
            artwork: [{ src: 'https://i.imgur.com/CgvdgMA.png', sizes: '96x96', type: 'image/png' }, { src: 'https://i.imgur.com/CgvdgMA.png', sizes: '128x128', type: 'image/png' }, { src: 'https://i.imgur.com/CgvdgMA.png', sizes: '192x192', type: 'image/png' }, { src: 'https://i.imgur.com/CgvdgMA.png', sizes: '256x256', type: 'image/png' }, { src: 'https://i.imgur.com/CgvdgMA.png', sizes: '384x384', type: 'image/png' }, { src: 'https://i.imgur.com/CgvdgMA.png', sizes: '512x512', type: 'image/png' }, ]
        });
        navigator.mediaSession.playbackState = 'playing';
        if (!mediaSessionInitialized) {
            navigator.mediaSession.setActionHandler('play', () => {
                if (currentRediyoAudio) {
                    currentRediyoAudio.play();
                    const rediyoPlayerElement = document.querySelector(`.rediyo-kai-tsaye-player[data-postid="${currentRediyoAudio.dataset.postid}"]`);
                    if (rediyoPlayerElement) {
                        const rediyoBtn = rediyoPlayerElement.querySelector('.rediyo-kai-tsaye-button');
                        if (rediyoBtn) rediyoBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
                    }
                } else if (currentPlayingAudio) {
                    currentPlayingAudio.play();
                    const prevBtn = currentPlayingAudio.parentElement.querySelector('.audio-play-btn');
                    if (prevBtn) prevBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
                }
                navigator.mediaSession.playbackState = 'playing';
            });
            navigator.mediaSession.setActionHandler('pause', () => {
                if (currentRediyoAudio) {
                    currentRediyoAudio.pause();
                    const rediyoPlayerElement = document.querySelector(`.rediyo-kai-tsaye-player[data-postid="${currentRediyoAudio.dataset.postid}"]`);
                    if (rediyoPlayerElement) {
                        const rediyoBtn = rediyoPlayerElement.querySelector('.rediyo-kai-tsaye-button');
                        if (rediyoBtn) rediyoBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
                    }
                } else if (currentPlayingAudio) {
                    currentPlayingAudio.pause();
                    const prevBtn = currentPlayingAudio.parentElement.querySelector('.audio-play-btn');
                    if (prevBtn) prevBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
                }
                navigator.mediaSession.playbackState = 'paused';
            });
            navigator.mediaSession.setActionHandler('stop', () => {
                if (currentRediyoAudio) {
                    currentRediyoAudio.pause();
                    currentRediyoAudio.currentTime = 0;
                    const rediyoPlayerElement = document.querySelector(`.rediyo-kai-tsaye-player[data-postid="${currentRediyoAudio.dataset.postid}"]`);
                    if (rediyoPlayerElement) {
                        const rediyoBtn = rediyoPlayerElement.querySelector('.rediyo-kai-tsaye-button');
                        if (rediyoBtn) rediyoBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
                    }
                    currentRediyoAudio = null;
                } else if (currentPlayingAudio) {
                    currentPlayingAudio.pause();
                    currentPlayingAudio.currentTime = 0;
                    const prevBtn = currentPlayingAudio.parentElement.querySelector('.audio-play-btn');
                    if (prevBtn) prevBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
                    currentPlayingAudio = null;
                }
                navigator.mediaSession.playbackState = 'stopped';
                navigator.mediaSession.metadata = null;
            });
            mediaSessionInitialized = true;
        }
    }
}

// ==== VIDEO AUTOPLAY (MODERN) ====
function setupVideoAutoPlay(container) {
    const videoElement = container.querySelector('.site5-kaitsaye-video');
    if (!videoElement || videoElement.tagName !== 'VIDEO') return;
    videoElement.preload = "auto";
    videoElement.muted = true;
    videoElement.playsInline = true;
    const videoObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                videoElement.play().catch(e => console.error("Video autoplay failed:", e));
            } else {
                videoElement.pause();
            }
        });
    }, {
        threshold: 0.6
    });
    videoObserver.observe(videoElement);
}

// ==== INTERSECTION OBSERVER (SEE) ====
function setupKaitsayeIntersection(container, p) {
    if (!container || !p?.postid) {
        console.warn("Missing container or postid for setupKaitsayeIntersection.");
        return;
    }
    const viewBtnBadge = container.querySelector('.kaitsaye-action-btn.view .kaitsaye-action-badge');
    const LOCAL_VIEW_KEY = `kaitsaye-view-${p.postid}`;
    if (localStorage.getItem(LOCAL_VIEW_KEY)) {
        if (viewBtnBadge) {
            viewBtnBadge.textContent = formatCount(p.see || 0);
        }
        return;
    }
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting && !localStorage.getItem(LOCAL_VIEW_KEY)) {
                localStorage.setItem(LOCAL_VIEW_KEY, "true");
                const seeRef = ref(db, `KaiTsayePost/see`);
                runTransaction(seeRef, (currentVal) => {
                    return (currentVal || 0) + 1;
                }).then((result) => {
                    const newSeeCount = result.snapshot.val();
                    if (viewBtnBadge) {
                        viewBtnBadge.textContent = formatCount(newSeeCount);
                    }
                    p.see = newSeeCount;
                }).catch(error => {
                    console.error("Firebase transaction for 'see' failed:", error);
                    localStorage.removeItem(LOCAL_VIEW_KEY);
                    if (viewBtnBadge) {
                        viewBtnBadge.textContent = formatCount((p.see || 0) + 1);
                    }
                });
                observer.unobserve(entry.target);
                observer.disconnect();
            }
        });
    }, {
        threshold: 0.5
    });
    observer.observe(container);
}

// ==== ACTIONS (LOVE, COMMENT, DOWNLOAD) ====
function setupKaitsayeActions(container, p) {
    const loveBtn = container.querySelector('.kaitsaye-action-btn.love');
    const loveBadge = loveBtn ? loveBtn.querySelector('.kaitsaye-action-badge') : null;
    const LOCAL_LOVED_KEY_PREFIX = `site5-loved-`;
    const hasLoved = localStorage.getItem(`${LOCAL_LOVED_KEY_PREFIX}${p.postid}`) === "true";
    if (hasLoved) {
        loveBtn.classList.add('active');
    }
    if (loveBtn) {
        loveBtn.onclick = function() {
            if (localStorage.getItem(`${LOCAL_LOVED_KEY_PREFIX}${p.postid}`) === "true") {
                showSite5Push("Ka riga ka yi like ga wannan post!", "fa-info-circle");
                return;
            }
            loveBtn.classList.add('active');
            localStorage.setItem(`${LOCAL_LOVED_KEY_PREFIX}${p.postid}`, "true");
            let currentLoveCount = parseInt(loveBadge.textContent.replace(/[mk]/g, '')) || (p.love || 0);
            if (loveBadge) loveBadge.textContent = formatCount(currentLoveCount + 1);
            const loveRef = ref(db, `KaiTsayePost/love`);
            runTransaction(loveRef, (val) => (val || 0) + 1).then(() => {
                showSite5Push("Mun Gode da LikeüòÄ!", "fa-heart", 1800);
            }).catch(error => {
                console.error("Love transaction failed:", error);
                loveBtn.classList.remove('active');
                localStorage.removeItem(`${LOCAL_LOVED_KEY_PREFIX}${p.postid}`);
                if (loveBadge) loveBadge.textContent = formatCount(currentLoveCount);
            });
        };
    }
    const commentBtn = container.querySelector('.kaitsaye-action-btn.comment');
    if (commentBtn) {
        commentBtn.onclick = function() {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    window.location.href = `comment.html?postId=${p.postid}`;
                } else {
                    showSite5Push("Dole ka yi rigista ko login domin shiga wannan shafin!", "fa-user-lock");
                }
            });
        };
    }
    const dlBtn = container.querySelector('.kaitsaye-action-btn.download');
    if (dlBtn) {
        dlBtn.onclick = async function() {
            let url = p.photoLink || p.videoLink || p.audioPostLink;
            if (!url) return showSite5Push("Babu abun da za a sauke!", "fa-xmark");
            try {
                const response = await fetch(url);
                const blob = await response.blob();
                const filename = url.substring(url.lastIndexOf('/') + 1);
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = filename || "KaiTsaye-post";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(a.href);
                showSite5Push("An fara sauke file.", "fa-arrow-down");
            } catch (error) {
                console.error("Error downloading file:", error);
                showSite5Push("An sami matsala wajen sauke file.", "fa-xmark");
            }
        };
    }
}

// ==== RECOVERY IF OFFLINE ====
function loadKaitsayeLocal() {
    showKaitsayeLoading();
    initializeKaitsayePostListener();
}

// ==== MAIN ENTRY POINT ====
window.addEventListener("DOMContentLoaded", () => {
    loadKaitsayeLocal();
});

// ==== UPLOAD BUTTON DEMO ====
window.site5UploadBtnClick = function() {
    showSite5Push("Kai Tsaye A Yau... ka jira.", "fa-spinner");
};

// üö¶‚úîÔ∏èSite 5 JS ya kare daga nan



// üö¶‚úîÔ∏èSite 6 JS ya fara daga nan
const WORKER_URL = "https://worker33.lawaliharuna943.workers.dev/site6";
const WORKER_API_KEY = "@haruna66";
const WASANNIN_KEY = "site6_tw_wasanninyau";
const LABARI_KEY = "site6_labariGame";
const MAX_GAMES_PER_VIEW = 4;
const site6Section = document.getElementById('site6-wasanninyau');
const site6Navbar = document.getElementById('site6-navbar');
const site6PrevDay = document.getElementById('site6-prevDay');
const site6NextDay = document.getElementById('site6-nextDay');
const site6DateDisplay = document.getElementById('site6-dateDisplay');
const site6Loader = document.getElementById('site6-loader');
let site6DayOffset = 0; // 0 = today, 1 = tomorrow, etc.
let site6GamesAll = [];
let site6ScrollIndex = 0;
// Date helpers
function site6GetDateString(offsetDays=0) {
    const target = new Date();
    target.setDate(target.getDate() + offsetDays);
    const yyyy = target.getFullYear();
    const mm = String(target.getMonth()+1).padStart(2,'0');
    const dd = String(target.getDate()).padStart(2,'0');
    return `${yyyy}-${mm}-${dd}`;
}
function site6FormatDateDisplay(offsetDays=0) {
    const target = new Date();
    target.setDate(target.getDate() + offsetDays);
    const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
    return `${days[target.getDay()]}, ${target.toLocaleString('en-US',{month:'long'})} ${target.getDate()} ${target.getFullYear()}`;
}
// Loader helpers
function site6ShowLoader(show=true) {
    site6Loader.style.display = show ? "block" : "none";
    site6Section.style.display = show ? "none" : "block";
}
// API fetch via Worker
async function site6FetchGames(offsetDays=0) {
    site6ShowLoader(true);
    const dateStr = site6GetDateString(offsetDays);
    try {
        const res = await fetch(WORKER_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "x-api-key": WORKER_API_KEY
            },
            body: JSON.stringify({
                dateFrom: dateStr,
                dateTo: dateStr
            })
        });
        if (!res.ok) {
            const errorData = await res.json();
            throw new Error(`API Error: ${errorData.message}`);
        }
        const data = await res.json();
        // Normalize data
        site6GamesAll = (data.matches || []).map(site6NormalizeGameData);
        localStorage.setItem(WASANNIN_KEY, JSON.stringify(site6GamesAll));
        site6ScrollIndex = 0;
        site6RenderGames();
    } catch (e) {
        console.error('Fetching games failed:', e);
        site6GamesAll = [];
        site6Section.innerHTML = `<p style="text-align:center; color: red;">Kuskure ya faru wajen karbar wasanni.<br>Muna kokarin gyarawa.</p>`;
    }
    site6ShowLoader(false);
}
// Data normalizer
function site6NormalizeGameData(game) {
    return {
        id: game.id,
        code: game.id,
        team1name: game.homeTeam?.name || "",
        team2name: game.awayTeam?.name || "",
        team1logo: game.homeTeam?.crest || "https://cdn-icons-png.flaticon.com/512/197/197374.png",
        team2logo: game.awayTeam?.crest || "https://cdn-icons-png.flaticon.com/512/197/197374.png",
        startTime: game.utcDate,
        status: game.status,
        venue: game.venue || "",
        finished: game.status === "FINISHED",
        score: game.score?.fullTime ? `${game.score.fullTime.home} - ${game.score.fullTime.away}` : "",
    };
}
// Game cards renderer (scroller)
function site6RenderGames() {
    site6Navbar.style.display = site6GamesAll.length ? "flex" : "none";
    if (!site6GamesAll.length) {
        site6Section.innerHTML = `<p style="text-align:center;">Babu wasannin da aka samu a wannan ranar.</p>`;
        return;
    }
    // Only show 4 at a time
    const viewGames = site6GamesAll.slice(site6ScrollIndex, site6ScrollIndex+MAX_GAMES_PER_VIEW);
    const scroller = document.createElement('div');
    scroller.className = "wasanni-scroller";
    viewGames.forEach(g => scroller.appendChild(site6RenderGameCard(g)));
    site6Section.innerHTML = "";
    site6Section.appendChild(scroller);
    // Hide nav buttons if at edge
    site6PrevDay.disabled = site6DayOffset <= -4;
    site6NextDay.disabled = site6DayOffset >= 4;
    if (site6GamesAll.length <= MAX_GAMES_PER_VIEW) {
        scroller.style.justifyContent = 'center';
    }
    // Scroll nav for more than 4 games
    if (site6GamesAll.length > MAX_GAMES_PER_VIEW) {
        // Next/prev game batch
        scroller.addEventListener('wheel', function(e) {
            if (e.deltaX > 0) site6ScrollNext();
            else if (e.deltaX < 0) site6ScrollPrev();
        });
    }
}
// Individual game card
function site6RenderGameCard(game) {
    const c = document.createElement('div');
    c.className = "wasanni-card" + (game.finished ? " site6-finished" : "");
    c.innerHTML = `
        <div class="wasanni-teams">
            <div class="wasanni-team">
                <img class="wasanni-team-logo" src="${game.team1logo}" alt="">
                <span class="wasanni-team-name">${game.team1name}</span>
            </div>
            <span class="wasanni-vs">VS</span>
            <div class="wasanni-team">
                <img class="wasanni-team-logo" src="${game.team2logo}" alt="">
                <span class="wasanni-team-name">${game.team2name}</span>
            </div>
        </div>
        <div class="wasanni-time">${site6FormatGameTime(game.startTime)}</div>
        <div class="wasanni-status">
            ${game.finished ? `<span title="Finished"><i class="fa fa-check-double"></i> FINISHED</span>` : game.status}
            ${game.score && game.finished ? `<br><b>${game.score}</b>` : ""}
            ${game.venue ? `<br><i class="fa fa-location-dot"></i> ${game.venue}` : ""}
        </div>
    `;
    c.onclick = () => site6OnGameClick(game);
    return c;
}
// On game click
function site6OnGameClick(game) {
    localStorage.setItem(LABARI_KEY, JSON.stringify(game));
    window.location = "labarinWasa.html";
}
// Format game time for user's timezone
function site6FormatGameTime(ts) {
    const date = new Date(ts);
    // Yi amfani da Intl.DateTimeFormat don fassara lokacin zuwa na'urar mai amfani
    const formatter = new Intl.DateTimeFormat(navigator.language, {
        hour: '2-digit',
        minute: '2-digit',
        hour12: true, // Wannan zai nuna 12-hour format (e.g., 03:30 PM)
        timeZoneName: 'short' // Wannan zai nuna sunan timezone (e.g., GMT, WAT)
    });
    return formatter.format(date);
}
// Navigation controls
site6PrevDay.onclick = function() {
    if (site6DayOffset > -4) {
        site6DayOffset--;
        site6UpdateDay();
    }
};
site6NextDay.onclick = function() {
    if (site6DayOffset < 4) {
        site6DayOffset++;
        site6UpdateDay();
    }
};
function site6UpdateDay() {
    site6DateDisplay.innerHTML = `<i class="fa fa-futbol"></i> ${site6DayOffset === 0 ? "Today" : site6DayOffset === 1 ? "Tomorrow" : site6FormatDateDisplay(site6DayOffset)} <i class="fa fa-futbol"></i>`;
    site6FetchGames(site6DayOffset);
}
// Scroller navigation
function site6ScrollNext() {
    if (site6ScrollIndex + MAX_GAMES_PER_VIEW < site6GamesAll.length) {
        site6ScrollIndex += MAX_GAMES_PER_VIEW;
        site6RenderGames();
    }
}
function site6ScrollPrev() {
    if (site6ScrollIndex - MAX_GAMES_PER_VIEW >= 0) {
        site6ScrollIndex -= MAX_GAMES_PER_VIEW;
        site6RenderGames();
    }
}
// Initialization
function site6Init() {
    site6DateDisplay.innerHTML = `<i class="fa fa-futbol"></i> Today ${site6FormatDateDisplay(0)} <i class="fa fa-futbol"></i>`;
    const cached = localStorage.getItem(WASANNIN_KEY);
    if (cached) {
        try {
            site6GamesAll = JSON.parse(cached) || [];
            site6RenderGames();
        } catch {}
    }
    site6FetchGames(0);
}
document.addEventListener("DOMContentLoaded", site6Init);
// üö¶‚úîÔ∏èSite 6 JS ya kare daga nan




// üö¶‚úîÔ∏èSite 7 JS ya fara daga nan

const site7Container = document.getElementById('site7-wasaninmasuzabi');

const ZABI_KEY = "tw_wasaninmasuzabi"; // Key for localStorage for posts

const wasaniZabiRef = ref(db, "wasaniMasuZabi");
let aite7_userid = null; // Set this with your firebase auth logic
// Helper: Format counts for k/m/b

function aite7_numFormat(num) {
    num = Number(num) || 0;
    if (num >= 1e9) return (num / 1e9).toFixed(1).replace(/\.0$/, '') + 'b';
    if (num >= 1e6) return (num / 1e6).toFixed(1).replace(/\.0$/, '') + 'm';
    if (num >= 1e3) return (num / 1e3).toFixed(1).replace(/\.0$/, '') + 'k';
    return num;
}
// Helper: Save & Load LocalStorage

function aite7_saveLocal(data) {
    localStorage.setItem(ZABI_KEY, JSON.stringify(data));
}

function aite7_loadLocal() {
    try {
        const d = localStorage.getItem(ZABI_KEY);
        return d ? JSON.parse(d) : [];
    } catch {
        return [];
    }
}
// Helper: Set UserID from firebase auth

function aite7_setUserId(userId) {
    aite7_userid = userId;
}
// Helper: Audio player controls per post

function aite7_audioPlayer(audioUrl, postId) {
    const wrap = document.createElement('div');
    wrap.className = "aite7-audio-player-wrap";
    const audio = document.createElement('audio');
    audio.src = audioUrl;
    audio.preload = "metadata";
    audio.style.display = "none";
    let playing = false;
    let seeked = false;
    let lastTime = parseFloat(localStorage.getItem(`aite7_audio_${postId}`)) || 0;
    const btn = document.createElement('button');
    btn.className = "aite7-audio-btn";
    btn.innerHTML = `<i class="fa-solid fa-play"></i>`; // Font Awesome Play icon
    btn.onclick = () => {
        if (audio.paused) {
            audio.currentTime = lastTime;
            audio.play();
        } else {
            audio.pause();
        }
    };
    const progress = document.createElement('input');
    progress.type = "range";
    progress.className = "aite7-audio-progress";
    progress.value = 0;
    progress.min = 0;
    progress.max = 100;
    progress.step = 0.1;
    const timeLabel = document.createElement('span');
    timeLabel.className = "aite7-audio-time";
    timeLabel.textContent = "00:00";
    audio.onloadedmetadata = () => {
        if (lastTime > 0 && lastTime < audio.duration) audio.currentTime = lastTime;
        progress.max = 100;
        progress.value = audio.currentTime / audio.duration * 100 || 0;
        timeLabel.textContent = aite7_timeFmt(audio.currentTime, audio.duration);
    };
    audio.ontimeupdate = () => {
        progress.value = audio.currentTime / audio.duration * 100 || 0;
        timeLabel.textContent = aite7_timeFmt(audio.currentTime, audio.duration);
        localStorage.setItem(`aite7_audio_${postId}`, audio.currentTime);
    };
    progress.oninput = e => {
        if (audio.duration) {
            audio.currentTime = e.target.value / 100 * audio.duration;
            seeked = true;
        }
    };
    audio.onplay = () => {
        btn.innerHTML = `<i class="fa-solid fa-pause"></i>`; // Font Awesome Pause icon
        playing = true;
    };
    audio.onpause = () => {
        btn.innerHTML = `<i class="fa-solid fa-play"></i>`; // Font Awesome Play icon
        playing = false;
        lastTime = audio.currentTime;
    };
    audio.onended = () => {
        btn.innerHTML = `<i class="fa-solid fa-play"></i>`; // Font Awesome Play icon
        playing = false;
        lastTime = 0;
        audio.currentTime = 0;
        localStorage.removeItem(`aite7_audio_${postId}`);
    };
    wrap.append(btn, progress, timeLabel, audio);
    return wrap;
}
// Helper: Time format

function aite7_timeFmt(current, duration) {
    const c = Math.floor(current || 0),
        d = Math.floor(duration || 0);
    const fm = (v) => v < 10 ? '0' + v : v;
    return `${fm(Math.floor(c / 60))}:${fm(c % 60)}` + (duration ? ` / ${fm(Math.floor(d / 60))}:${fm(d % 60)}` : '');
}
// Helper: Download file (for both image and audio)

function aite7_downloadFile(url, name) {
    const link = document.createElement('a');
    link.href = url;
    link.download = name || "file";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    aite7_pushNotify("An sauke fayil …óin zuwa gallery naka!");
}
// Helper: Push notification (simple top bar)

function aite7_pushNotify(msg) {
    let bar = document.getElementById('aite7-notify-bar');
    if (!bar) {
        bar = document.createElement('div');
        bar.id = "aite7-notify-bar";
        bar.style.cssText = `
            position: fixed; top: 16px; left: 50%; transform: translateX(-50%);
            background: #2d90ff; color: #fff; padding: 0.7rem 2rem; border-radius: 22px;
            font-size: 1.07rem; z-index: 20012; box-shadow: 0 2px 11px #2d90ff44;
            transition: opacity 0.3s ease-out; opacity: 0;
        `;
        document.body.appendChild(bar);
    }
    bar.textContent = msg;
    bar.style.opacity = "1";
    setTimeout(() => {
        bar.style.opacity = "0";
    }, 3000);
}
// Helper: See count update

function aite7_incrementSee(post) {
    if (!post || !post.postCode) return;
    const viewKey = `aite7_view_${post.postCode}_${aite7_userid || 'guest'}`;
    if (!sessionStorage.getItem(viewKey)) {
        const postRef = ref(db, `wasaniMasuZabi/${post.postCode}/see`);
        // Increment Firebase count
        set(postRef, (Number(post.see) || 0) + 1);
        sessionStorage.setItem(viewKey, "1"); // Mark as viewed for this session
    }
}
// Helper: Like update

function aite7_likePost(post, btn, icon, countLabel) {
    const key = "aite7_like_" + post.postCode + (aite7_userid || 'guest');
    if (localStorage.getItem(key)) {
        return;
    }
    localStorage.setItem(key, "1");
    btn.classList.add("liked");
    icon.classList.add("liked");
    const postRef = ref(db, `wasaniMasuZabi/${post.postCode}/like`);
    set(postRef, (Number(post.like) || 0) + 1);
    // Update UI count immediately based on current count + 1
    let currentCount = Number(countLabel.dataset.currentCount) || 0;
    currentCount++;
    countLabel.textContent = aite7_numFormat(currentCount);
    countLabel.dataset.currentCount = currentCount; // Update the stored count in dataset
}
// Helper: Scroll left/right

function aite7_scrollBy(scroller, dir = 1) {
    scroller.scrollBy({
        left: dir * 350,
        behavior: "smooth"
    });
}
// Function to open image in fullscreen/modal with download and close options

function aite7_viewImage(imageUrl, postId) {
    const modal = document.createElement('div');
    modal.className = "aite7-image-modal";
    modal.onclick = (e) => {
        if (e.target === modal) modal.remove(); // Close if clicked outside image
    };
    const img = document.createElement('img');
    img.src = imageUrl;
    img.alt = "Post Image";
    const closeBtn = document.createElement('button');
    closeBtn.className = "aite7-modal-close-btn";
    closeBtn.innerHTML = `<i class="fa-solid fa-times-circle"></i>`; // Font Awesome X icon
    closeBtn.onclick = () => modal.remove();
    const downloadBtn = document.createElement('button');
    downloadBtn.className = "aite7-modal-download-btn";
    downloadBtn.innerHTML = `<i class="fa-solid fa-download"></i> Download`;
    downloadBtn.onclick = () => aite7_downloadFile(imageUrl, `image_${postId}.jpg`);
    modal.append(img, closeBtn, downloadBtn);
    document.body.appendChild(modal);
}
// Function to handle login requirement for specific actions

function aite7_handleLoginRequired(post) {
    onAuthStateChanged(auth, (user) => {
        if (user) {
            window.location.href = `wanniComent.html?postCode=${post.postCode}`;
        } else {
            aite7_pushNotify("Dole ka yi rigista ko login domin shiga wannan shafin!", "fa-user-lock");
        }
    });
}
// Main render function

function aite7_render(posts) {
    site7Container.innerHTML = "";
    if (!posts || !posts.length) {
        site7Container.style.display = "none";
        return;
    }
    site7Container.style.display = "block";
    // Title bar
    const titleBar = document.createElement('div');
    titleBar.className = "aite7-title-bar";
    titleBar.innerHTML = `<span>üí†</span><span>‚öΩWasanni Masu Zafi‚öΩ</span><span>üí†</span>`;
    site7Container.appendChild(titleBar);
    // Scroller container
    const scrollerWrap = document.createElement('div');
    scrollerWrap.className = "aite7-scroller-container";
    site7Container.appendChild(scrollerWrap);
    // Scroller
    const scroller = document.createElement('div');
    scroller.className = "aite7-scroller";
    scrollerWrap.appendChild(scroller);
    // Left/Right scroll buttons
    const leftBtn = document.createElement('button');
    leftBtn.className = "aite7-scroll-btn aite7-left";
    leftBtn.innerHTML = `<i class="fa-solid fa-angle-left"></i>`;
    leftBtn.onclick = () => aite7_scrollBy(scroller, -1);
    scrollerWrap.appendChild(leftBtn);
    const rightBtn = document.createElement('button');
    rightBtn.className = "aite7-scroll-btn aite7-right";
    rightBtn.innerHTML = `<i class="fa-solid fa-angle-right"></i>`;
    rightBtn.onclick = () => aite7_scrollBy(scroller, 1);
    scrollerWrap.appendChild(rightBtn);

    function updateScrollBtns() {
        leftBtn.hidden = (scroller.scrollLeft < 10);
        rightBtn.hidden = (scroller.scrollLeft + scroller.offsetWidth + 10 >= scroller.scrollWidth);
    }
    scroller.addEventListener('scroll', updateScrollBtns);
    setTimeout(updateScrollBtns, 500);
    // Render posts
    posts.forEach((post, idx) => {
        if (!post || !post.postCode) return;
        const card = document.createElement('div');
        card.className = "aite7-card";
        card.setAttribute("data-post", post.postCode);
        // Teams section
        const teamsDiv = document.createElement('div');
        teamsDiv.className = "aite7-teams";
        // Home Team Column
        const homeTeamCol = document.createElement('div');
        homeTeamCol.className = "aite7-team-col";
        const team1Logo = document.createElement('img');
        team1Logo.className = "aite7-game-logo";
        team1Logo.src = post.game1logo || "";
        team1Logo.alt = "Home Team Logo";
        homeTeamCol.appendChild(team1Logo);
        const team1Name = document.createElement('span');
        team1Name.className = "aite7-game-name";
        team1Name.textContent = post.game1Name || "";
        homeTeamCol.appendChild(team1Name);
        teamsDiv.appendChild(homeTeamCol);
        const vsSpan = document.createElement('span');
        vsSpan.className = "aite7-vs-label";
        vsSpan.textContent = "VS";
        teamsDiv.appendChild(vsSpan);
        // Away Team Column
        const awayTeamCol = document.createElement('div');
        awayTeamCol.className = "aite7-team-col";
        const team2Logo = document.createElement('img'); // Logo yanzu yana farko
        team2Logo.className = "aite7-game-logo";
        team2Logo.src = post.game2logo || "";
        team2Logo.alt = "Away Team Logo";
        awayTeamCol.appendChild(team2Logo);
        const team2Name = document.createElement('span');
        team2Name.className = "aite7-game-name";
        team2Name.textContent = post.game2Name || "";
        awayTeamCol.appendChild(team2Name);
        teamsDiv.appendChild(awayTeamCol);
        card.appendChild(teamsDiv);
        // Match Time
        const matchTimeDiv = document.createElement('div');
        matchTimeDiv.className = "aite7-game-time";
        matchTimeDiv.textContent = post.payGameTime || "";
        card.appendChild(matchTimeDiv);
        // Score Bar / Vote Boxes
        const scoreBarDiv = document.createElement('div');
        scoreBarDiv.className = "aite7-score-bar";
        // Home Vote Box
        const homeVoteBox = document.createElement('div');
        homeVoteBox.className = "aite7-vote-box";
        homeVoteBox.dataset.side = "home";
        const homeTeamSpan = document.createElement('span');
        homeTeamSpan.innerHTML = `<i class="fa-solid fa-user-ninja aite7-team-icon"></i> <span class="aite7-box-count" data-current-count="${post.game1box || 0}">${aite7_numFormat(post.game1box || 0)}</span>`;
        homeVoteBox.appendChild(homeTeamSpan);
        const homeIndicator = document.createElement('span');
        homeIndicator.className = "aite7-vote-indicator";
        homeVoteBox.appendChild(homeIndicator);
        const homeCheckMark = document.createElement('span');
        homeCheckMark.className = "aite7-check-mark";
        homeCheckMark.innerHTML = `<i class="fa-solid fa-check"></i>`;
        homeCheckMark.style.display = 'none'; // Hide by default
        homeVoteBox.appendChild(homeCheckMark);
        // Away Vote Box
        const awayVoteBox = document.createElement('div');
        awayVoteBox.className = "aite7-vote-box";
        awayVoteBox.dataset.side = "away";
        const awayTeamSpan = document.createElement('span');
        awayTeamSpan.innerHTML = `<i class="fa-solid fa-user-ninja aite7-team-icon"></i> <span class="aite7-box-count" data-current-count="${post.game2box || 0}">${aite7_numFormat(post.game2box || 0)}</span>`;
        awayVoteBox.appendChild(awayTeamSpan);
        const awayIndicator = document.createElement('span');
        awayIndicator.className = "aite7-vote-indicator";
        awayVoteBox.appendChild(awayIndicator);
        const awayCheckMark = document.createElement('span');
        awayCheckMark.className = "aite7-check-mark";
        awayCheckMark.innerHTML = `<i class="fa-solid fa-check"></i>`;
        awayCheckMark.style.display = 'none'; // Hide by default
        awayVoteBox.appendChild(awayCheckMark);
        // Divider
        const dividerDiv = document.createElement('div');
        dividerDiv.className = "aite7-divider";
        dividerDiv.textContent = "‚ûñ‚ûñ‚ûñ";
        scoreBarDiv.append(homeVoteBox, dividerDiv, awayVoteBox);
        card.appendChild(scoreBarDiv);
        // Check local storage for vote status and apply styles
        const votedKey = `aite7_voted_${post.postCode}_${aite7_userid || 'guest'}`;
        const votedSide = localStorage.getItem(votedKey);
        if (votedSide) {
            homeVoteBox.classList.add('disabled');
            awayVoteBox.classList.add('disabled');
            if (votedSide === 'home') {
                homeVoteBox.classList.add('voted');
                homeCheckMark.style.display = 'flex';
            } else if (votedSide === 'away') {
                awayVoteBox.classList.add('voted');
                awayCheckMark.style.display = 'flex';
            }
        }
        // Add click listeners for vote boxes
        homeVoteBox.onclick = (e) => {
            e.stopPropagation();
            if (homeVoteBox.classList.contains('disabled')) {
                return;
            }
            // Disable both boxes
            homeVoteBox.classList.add('voted', 'disabled');
            awayVoteBox.classList.add('disabled');
            homeCheckMark.style.display = 'flex';
            localStorage.setItem(votedKey, 'home'); // Store vote
            // Increment Firebase
            const homeBoxRef = ref(db, `wasaniMasuZabi/${post.postCode}/game1box`);
            const currentHomeCount = Number(homeTeamSpan.querySelector('.aite7-box-count').dataset.currentCount);
            set(homeBoxRef, currentHomeCount + 1);
            homeTeamSpan.querySelector('.aite7-box-count').textContent = aite7_numFormat(currentHomeCount + 1);
            homeTeamSpan.querySelector('.aite7-box-count').dataset.currentCount = currentHomeCount + 1;
        };

        awayVoteBox.onclick = (e) => {
            e.stopPropagation();
            if (awayVoteBox.classList.contains('disabled')) {
                return;
            }
            // Disable both boxes
            awayVoteBox.classList.add('voted', 'disabled');
            homeVoteBox.classList.add('disabled');
            awayCheckMark.style.display = 'flex';
            localStorage.setItem(votedKey, 'away'); // Store vote
            // Increment Firebase
            const awayBoxRef = ref(db, `wasaniMasuZabi/${post.postCode}/game2box`);
            const currentAwayCount = Number(awayTeamSpan.querySelector('.aite7-box-count').dataset.currentCount);
            set(awayBoxRef, currentAwayCount + 1);
            awayTeamSpan.querySelector('.aite7-box-count').textContent = aite7_numFormat(currentAwayCount + 1);
            awayTeamSpan.querySelector('.aite7-box-count').dataset.currentCount = currentAwayCount + 1;
        };
        // Poster / Image
        const posterDiv = document.createElement('div');
        posterDiv.className = "aite7-poster";
        if (post.photalinlink) {
            const posterImg = document.createElement('img');
            posterImg.src = post.photalinlink;
            posterImg.alt = "Photo Show";
            posterImg.onclick = (e) => {
                e.stopPropagation();
                aite7_viewImage(post.photalinlink, post.postCode);
            };
            posterDiv.appendChild(posterImg);
        }
        card.appendChild(posterDiv);
        // Content (Text or Audio)
        const contentDiv = document.createElement('div');
        contentDiv.className = "aite7-content";
        if (post.test) {
            // Saita text
            contentDiv.textContent = post.test;
            // Create 'read more' inline link
            const readMoreBtn = document.createElement('a');
            readMoreBtn.href = "#";
            readMoreBtn.className = "aite7-read-more";
            readMoreBtn.textContent = " Kara Karantawa..";
            readMoreBtn.onclick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                aite7_handleLoginRequired(post);
            };
            // Add 'read more' inline (inside the content div)
            contentDiv.appendChild(readMoreBtn);
        } else if (post.audioLink) {
            contentDiv.appendChild(aite7_audioPlayer(post.audioLink, post.postCode));
        }
        card.appendChild(contentDiv);
        // Meta Info
        const metaInfoDiv = document.createElement('div');
        metaInfoDiv.className = "aite7-meta-info";
        // Like Button
        const likeItem = document.createElement('span');
        likeItem.className = "aite7-icon-item";
        likeItem.innerHTML = `<i class="fa-solid fa-thumbs-up"></i> <span></span> <span class="aite7-count" data-current-count="${post.like || 0}">${aite7_numFormat(post.like || 0)}</span>`;
        if (localStorage.getItem("aite7_like_" + post.postCode + (aite7_userid || 'guest'))) {
            likeItem.classList.add("liked");
        }
        likeItem.onclick = (e) => {
            e.stopPropagation();
            aite7_likePost(post, likeItem, likeItem.querySelector('i'), likeItem.querySelector('.aite7-count'));
        };
        metaInfoDiv.appendChild(likeItem);
        // Comments Count
        const commentItem = document.createElement('span');
        commentItem.className = "aite7-icon-item";
        commentItem.innerHTML = `<i class="fa-regular fa-comment"></i> <span></span> <span class="aite7-count" data-current-count="${post.totalComment || 0}">${aite7_numFormat(post.totalComment || 0)}</span>`;
        commentItem.onclick = (e) => {
            e.stopPropagation();
            aite7_handleLoginRequired(post);
        };
        metaInfoDiv.appendChild(commentItem);
        // See Count
        const seeItem = document.createElement('span');
        seeItem.className = "aite7-icon-item";
        seeItem.innerHTML = `<i class="fa-solid fa-eye"></i> <span></span> <span class="aite7-count" data-current-count="${post.see || 0}">${aite7_numFormat(post.see || 0)}</span>`;
        seeItem.onclick = (e) => {
            e.stopPropagation();
            let currentCount = Number(seeItem.querySelector('.aite7-count').dataset.currentCount);
            currentCount++;
            seeItem.querySelector('.aite7-count').textContent = aite7_numFormat(currentCount);
            seeItem.querySelector('.aite7-count').dataset.currentCount = currentCount;
        };
        metaInfoDiv.appendChild(seeItem);
        // Download Button (for image or audio)
        if (post.audioLink || post.photalinlink) {
            const downloadItem = document.createElement('span');
            downloadItem.className = "aite7-icon-item";
            downloadItem.innerHTML = `<i class="fa-solid fa-download"></i> <span></span>`;
            downloadItem.onclick = (e) => {
                e.stopPropagation();
                if (post.audioLink) aite7_downloadFile(post.audioLink, `audio_${post.postCode}.mp3`);
                else if (post.photalinlink) aite7_downloadFile(post.photalinlink, `image_${post.postCode}.jpg`);
            };
            metaInfoDiv.appendChild(downloadItem);
        }
        card.appendChild(metaInfoDiv);
        // Append to scroller
        scroller.appendChild(card);
        // Increment see if scrolled into view (using Intersection Observer)
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    aite7_incrementSee(post);
                    observer.unobserve(entry.target); // Stop observing once seen
                }
            });
        }, {
            threshold: 0.8
        }); // 80% of card visible
        observer.observe(card);
    });
}
// Firebase listener
onValue(wasaniZabiRef, (snap) => {
    if (!snap.exists()) {
        site7Container.innerHTML = "";
        localStorage.removeItem(ZABI_KEY);
        site7Container.style.display = "none";
        return;
    }
    const raw = snap.val();
    // Convert to array, newest first
    const list = Object.values(raw).filter(x => !!x.postCode).sort((a, b) => (b.PostTime || 0) - (a.PostTime || 0));
    aite7_saveLocal(list);
    aite7_render(list);
});
// Sync localStorage if Firebase data changes (useful for multiple tabs)
window.addEventListener('storage', function(e) {
    if (e.key === ZABI_KEY) {
        const list = aite7_loadLocal();
        aite7_render(list);
    }
    // Also update UI if individual post vote/like status changes in local storage
    if (e.key && (e.key.startsWith('aite7_voted_') || e.key.startsWith('aite7_like_'))) {
        const list = aite7_loadLocal();
        aite7_render(list); // Re-render to reflect changes
    }
});
// Initial load from localStorage if any
const cached = aite7_loadLocal();
if (cached && cached.length) aite7_render(cached);

// üö¶‚úîÔ∏èSite 7 JS ya kare daga nan


//üö¶‚úîÔ∏èSite 8 ya fara daganan

const site8 = document.getElementById('site8-posting');
const postingRef = ref(db, "Posting");
const POSTING_KEY = "tw_posting";
const site8Logo = "https://i.imgur.com/CgvdgMA.png";
const SITE8_LEARNMORE_TEXT = "Kara Karantawa..";
const SITE8_COMMENTS_PAGE = "viewsComent.html";
const MAX_TEXT_LENGTH_PREVIEW = 300;
const SEEN_POSTS_KEY = "tauraronwasa_seen_posts";

function site8_getSeenPosts() {
    let storedData = localStorage.getItem(SEEN_POSTS_KEY);
    let seenPosts = {};
    try {
        if (storedData) {
            seenPosts = JSON.parse(storedData);
        }
    } catch (e) {
        console.error("Error parsing seen posts from localStorage:", e);
        seenPosts = {};
    }
    return seenPosts;
}

function site8_addSeenPost(postId) {
    let seenPosts = site8_getSeenPosts();
    if (!seenPosts[postId]) {
        seenPosts[postId] = true;
        localStorage.setItem(SEEN_POSTS_KEY, JSON.stringify(seenPosts));
        return true;
    }
    return false;
}

function site8_incrementSee(postid) {
    if (!site8_addSeenPost(postid)) {
        return;
    }
    const postRef = ref(db, `Posting/${postid}`);
    runTransaction(postRef, (currentPost) => {
        if (currentPost) {
            const currentSee = currentPost.see || 0;
            currentPost.see = currentSee + 1;
            return currentPost;
        }
        return currentPost;
    })
    .then((snapshot) => {
        if (snapshot.committed) {
            console.log(`See count for ${postid} incremented. New count: ${snapshot.snapshot.val().see}`);
            const seeCountElement = document.querySelector(`.posting-card[data-postid="${postid}"] .see-count`);
            if (seeCountElement) {
                seeCountElement.textContent = site8_formatCount(snapshot.snapshot.val().see);
            }
        } else {
            console.log(`Transaction for ${postid} aborted or failed. It might have been updated by another user or didn't exist.`);
        }
    })
    .catch(error => {
        console.error("Error incrementing see count with transaction:", error);
    });
}

function site8_showPush(text) {
    let push = document.querySelector('.push-container');
    if (!push) {
        push = document.createElement('div');
        push.className = "push-container";
        document.body.appendChild(push);
    }
    push.textContent = text;
    push.classList.add('active');
    setTimeout(() => push.classList.remove('active'), 2800);
}

function site8_formatCount(val) {
    val = parseInt(val) || 0;
    if (val >= 1_000_000_000) return (val / 1_000_000_000).toFixed(1).replace(/\.0$/, '') + "b";
    if (val >= 1_000_000) return (val / 1_000_000).toFixed(1).replace(/\.0$/, '') + "m";
    if (val >= 1_000) return (val / 1_000).toFixed(1).replace(/\.0$/, '') + "k";
    return val.toString();
}

function site8_getYouTubeVideoId(url) {
    let videoId = null;
    const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i;
    const match = url.match(regex);
    if (match && match[1]) {
        videoId = match[1];
    }
    return videoId;
}

function site8_renderPostingCard(p) {
    if (!p.text && !p.photoLink1 && !p.videoLink && !p.audioLink) {
        return null;
    }
    let text = p.text || "";
    let previewText = text;
    let hasLearnMore = false;
    if (text.length > MAX_TEXT_LENGTH_PREVIEW) {
        previewText = text.substring(0, MAX_TEXT_LENGTH_PREVIEW);
        hasLearnMore = true;
    }
    let mediaHtml = "";
    let logoTextHtml = `<div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div>`;
    let audioControllerHtml = "";
    if (p.videoLink) {
        const isYoutube = /youtube\.com|youtu\.be/.test(p.videoLink);
        let ytId = isYoutube ? site8_getYouTubeVideoId(p.videoLink) : null;
        let videoSrc = p.videoLink;
        if (isYoutube && ytId) {
            videoSrc = `https://www.youtube.com/embed/${ytId}?controls=0&modestbranding=1&rel=0&showinfo=0&autoplay=0&enablejsapi=1`;
            mediaHtml = `
                <div class="posting-video-container youtube-embed" data-videoid="${ytId}">
                    <div class="youtube-thumbnail" style="background-image: url('https://img.youtube.com/vi/${ytId}/hqdefault.jpg');">
                        <div class="youtube-play-btn"><i class="fa-solid fa-play"></i></div>
                    </div>
                    <iframe class="posting-video youtube-iframe hidden" src="${videoSrc}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    <button class="video-fullscreen-btn" data-videourl="${videoSrc}"><i class="fa-solid fa-expand"></i></button>
                </div>
            `;
        } else {
            mediaHtml = `
                <div class="posting-video-container">
                    <iframe class="posting-video" src="${videoSrc}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    <button class="video-fullscreen-btn" data-videourl="${videoSrc}"><i class="fa-solid fa-expand"></i></button>
                </div>
            `;
        }
        if (p.audioLink) {
            audioControllerHtml = `<div class="posting-audio-container"><audio class="posting-audio-controller" src="${p.audioLink}" controls></audio></div>`;
        }
        logoTextHtml = `<div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div>`;
    } else if (p.photoLink1 && p.photoLink2) {
        mediaHtml = `
            <div class="posting-img-double-container">
                <img class="posting-img-double" src="${p.photoLink1}" alt="post-image-1">
                <img class="posting-img-double" src="${p.photoLink2}" alt="post-image-2">
            </div>
        `;
        if (p.audioLink) {
            audioControllerHtml = `<div class="posting-audio-container"><audio class="posting-audio-controller" src="${p.audioLink}" controls></audio></div>`;
        }
        logoTextHtml = `<div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div>`;
    } else if (p.audioLink && !p.text && !p.photoLink1) {
        mediaHtml = `<div class="posting-audio-full-container"><audio class="posting-audio-full" src="${p.audioLink}" controls></audio></div>`;
        logoTextHtml = "";
    } else if (p.audioLink) {
        logoTextHtml = `<div class="posting-audio-text-container"><audio class="posting-audio-small" src="${p.audioLink}" controls></audio><div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div></div>`;
        mediaHtml = p.photoLink1 ? `<img class="posting-img" src="${p.photoLink1}" alt="post-image-1">` : "";
    } else if (p.photoLink1) {
        mediaHtml = `<img class="posting-img" src="${p.photoLink1}" alt="post-image-1">`;
        logoTextHtml = `<div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div>`;
    } else {
        mediaHtml = "";
        logoTextHtml = `<div class="posting-text-below-logo" data-fulltext="${encodeURIComponent(text)}">${previewText}${hasLearnMore ? `<span class="posting-learnmore">${SITE8_LEARNMORE_TEXT}</span>` : ""}</div>`;
    }

    const c = document.createElement('div');
    c.className = "posting-card";
    c.dataset.postid = p.postid;
    const likedClass = localStorage.getItem(`liked_${p.postid}`) ? " active" : "";
    c.innerHTML = `
        <div class="posting-logo-row">
            <img class="posting-logo-img" src="${site8Logo}" alt="logo">
            <span class="posting-timestamp" id="postingTime-${p.postid}"></span>
        </div>
        ${logoTextHtml}
        <div class="posting-media">${mediaHtml}${audioControllerHtml}</div>
        <div class="posting-bottom">
            <span class="posting-action posting-action-see" title="See">
                <i class="fa-regular fa-eye"></i> <span class="see-count">${site8_formatCount(p.see || 0)}</span>
            </span>
            <span class="posting-action posting-action-comments" title="Comment" data-postid="${p.postid}">
                <i class="fa-regular fa-comment"></i> <span class="comment-count">${site8_formatCount(p.totalComment || 0)}</span>
            </span>
            <span class="posting-action posting-action-like${likedClass}" title="Like">
                <i class="fa-solid fa-thumbs-up"></i> <span class="like-count">${site8_formatCount(p.like || 0)}</span>
            </span>
            <span class="posting-action posting-action-download" title="Download">
                <i class="fa-solid fa-arrow-down"></i>
            </span>
        </div>
    `;

    const timestampElement = c.querySelector(`#postingTime-${p.postid}`);
    if (timestampElement && p.postingTime) {
        timestampElement.textContent = site8_formatTimestamp(p.postingTime);
    }

    const learnMoreBtn = c.querySelector('.posting-learnmore');
    const postTextElement = c.querySelector('.posting-text-below-logo');
    if (learnMoreBtn && postTextElement) {
        learnMoreBtn.addEventListener('click', () => {
            const fullText = decodeURIComponent(postTextElement.dataset.fulltext);
            postTextElement.innerHTML = fullText;
        });
    }

    const youtubeThumbnail = c.querySelector('.youtube-thumbnail');
    if (youtubeThumbnail) {
        youtubeThumbnail.addEventListener('click', function() {
            const videoContainer = this.parentElement;
            const iframe = videoContainer.querySelector('.youtube-iframe');
            this.classList.add('hidden');
            iframe.classList.remove('hidden');
            const youtubeSrc = iframe.src;
            if (!youtubeSrc.includes('autoplay=1')) {
                iframe.src = youtubeSrc + '&autoplay=1';
            }
        });
    }

    const commentBtn = c.querySelector('.posting-action-comments');
    if (commentBtn) {
        commentBtn.onclick = function() {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    window.location.href = `comment.html?postId=${p.postid}`;
                } else {
                    showSite5Push("Dole ka yi rigista ko login domin shiga wannan shafin!", "fa-user-lock");
                }
            });
        };
    }

    const likeButton = c.querySelector('.posting-action-like');
    if (likeButton) {
        likeButton.onclick = function() {
            if (localStorage.getItem(`liked_${p.postid}`)) {
                return;
            }
            site8_likePost(p.postid);
            this.classList.add("active");
            localStorage.setItem(`liked_${p.postid}`, 'true');
        };
    }

    c.querySelector('.posting-action-download').onclick = function() {
        let fileUrl = p.photoLink1 || p.photoLink2 || p.audioLink || p.videoLink || "";
        if (!fileUrl) return site8_showPush("Babu file da za a sauke.");
        if (site8_getYouTubeVideoId(fileUrl)) {
            return;
        }
        let fileName = `tauraronwasa-file.${fileUrl.split('.').pop().split('?')[0]}`;
        site8_downloadFile(fileUrl, fileName);
    };

    const imagesInCard = c.querySelectorAll('.posting-img, .posting-img-double');
    imagesInCard.forEach(img => {
        img.style.cursor = 'zoom-in';
        img.onclick = function() {
            site8_openImageViewer(this.src);
        };
    });

    const audioElement = c.querySelector('.posting-audio-controller, .posting-audio-full, .posting-audio-small');
    if (audioElement) {
        const audioCurrentTimeKey = `audio_current_time_${p.postid}`;
        const storedTime = parseFloat(localStorage.getItem(audioCurrentTimeKey));
        if (!isNaN(storedTime)) {
            audioElement.currentTime = storedTime;
        }
        audioElement.onpause = () => {
            localStorage.setItem(audioCurrentTimeKey, audioElement.currentTime);
        };
        audioElement.onended = () => {
            localStorage.removeItem(audioCurrentTimeKey);
        };
    }

    const videoFullscreenBtn = c.querySelector('.video-fullscreen-btn');
    if (videoFullscreenBtn) {
        videoFullscreenBtn.onclick = function() {
            const videoUrl = this.dataset.videourl;
            site8_openVideoFullscreen(videoUrl);
        };
    }

    return c;
}

let videoFullscreenViewer = null;
let currentFullScreenVideo = null;
function site8_openVideoFullscreen(videoSrc) {
    if (!videoFullscreenViewer) {
        videoFullscreenViewer = document.createElement('div');
        videoFullscreenViewer.className = 'site8-video-fullscreen-viewer';
        videoFullscreenViewer.innerHTML = `
            <div class="site8-video-fullscreen-content">
                <button class="site8-video-fullscreen-close-btn"><i class="fa-solid fa-xmark"></i></button>
                <iframe class="site8-fullscreen-video-frame" src="${videoSrc}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen" allowfullscreen></iframe>
            </div>
        `;
        document.body.appendChild(videoFullscreenViewer);
        const closeBtn = videoFullscreenViewer.querySelector('.site8-video-fullscreen-close-btn');
        closeBtn.onclick = site8_closeVideoFullscreen;
        document.addEventListener('keydown', function(e) {
            if (e.key === "Escape" && videoFullscreenViewer.classList.contains('active')) {
                site8_closeVideoFullscreen();
            }
        });
        window.addEventListener('orientationchange', function() {
            if (videoFullscreenViewer.classList.contains('active')) {
                const iframe = videoFullscreenViewer.querySelector('.site8-fullscreen-video-frame');
                if (iframe && iframe.requestFullscreen) {
                    iframe.requestFullscreen().catch(err => {
                        console.log(`Error attempting to enable fullscreen: ${err.message} (${err.name})`);
                    });
                }
            }
        });
    } else {
        videoFullscreenViewer.querySelector('.site8-fullscreen-video-frame').src = videoSrc;
    }
    videoFullscreenViewer.classList.add('active');
    const iframe = videoFullscreenViewer.querySelector('.site8-fullscreen-video-frame');
    if (iframe && iframe.requestFullscreen) {
        iframe.requestFullscreen().catch(err => {
            console.log(`Error attempting to enable fullscreen: ${err.message} (${err.name})`);
        });
    }
}

function site8_closeVideoFullscreen() {
    if (videoFullscreenViewer) {
        const iframe = videoFullscreenViewer.querySelector('.site8-fullscreen-video-frame');
        if (iframe) {
            iframe.src = "";
        }
        videoFullscreenViewer.classList.remove('active');
        if (document.fullscreenElement) {
            document.exitFullscreen();
        }
    }
}

const site8_renderPostingFeed = (feedList) => {
    const scroller = site8;
    scroller.innerHTML = '';
    if (!feedList || feedList.length === 0) {
        scroller.innerHTML = "<div class='no-posts'>Babu wani rubutu a halin yanzu.</div>";
        return;
    }
    const feedContainer = document.createElement('div');
    feedContainer.className = "posting-feed";
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const postId = entry.target.dataset.postid;
                site8_incrementSee(postId);
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.5 });
    feedList.forEach(post => {
        const card = site8_renderPostingCard(post);
        if (card) {
            feedContainer.appendChild(card);
            if (post.postid) {
                observer.observe(card);
            }
        }
    });
    if (feedContainer.children.length === 0) {
        scroller.innerHTML = "<div class='no-posts'>Babu wani rubutu a halin yanzu.</div>";
    } else {
        scroller.appendChild(feedContainer);
    }
};

function site8_formatTimestamp(timestamp) {
    const date = new Date(timestamp);
    const now = new Date();
    const diffMs = now - date;
    const diffSec = Math.round(diffMs / 1000);
    const diffMin = Math.round(diffSec / 60);
    const diffHr = Math.round(diffMin / 60);
    const diffDay = Math.round(diffHr / 24);
    if (diffSec < 60) return `${diffSec}s ago`;
    if (diffMin < 60) return `${diffMin}m ago`;
    if (diffHr < 24) return `${diffHr}h ago`;
    if (diffDay < 7) return `${diffDay}d ago`;
    return date.toLocaleDateString('ha-NG', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
    });
}

function site8_likePost(postid) {
    const postRef = ref(db, `Posting/${postid}`);
    runTransaction(postRef, (currentPost) => {
        if (currentPost) {
            const currentLike = currentPost.like || 0;
            currentPost.like = currentLike + 1;
            return currentPost;
        }
        return currentPost;
    })
    .then((snapshot) => {
        if (snapshot.committed) {
        site8_showPush("Mun Gode da 'Like'üòÄ!");
            const likeCountElement = document.querySelector(`.posting-card[data-postid="${postid}"] .like-count`);
            if (likeCountElement) {
                likeCountElement.textContent = site8_formatCount(snapshot.snapshot.val().like);
                const likeButton = document.querySelector(`.posting-card[data-postid="${postid}"] .posting-action-like`);
                if (likeButton) {
                    likeButton.classList.add("active");
                }
            }
        }
    })
    .catch(error => console.error("Error incrementing like count with transaction:", error));
}

function site8_downloadFile(fileUrl, fileName) {
    const link = document.createElement('a');
    link.href = fileUrl;
    link.download = fileName;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    site8_showPush("An sauke file!");
}

let imageViewer = null;
function site8_openImageViewer(src) {
    if (!imageViewer) {
        imageViewer = document.createElement('div');
        imageViewer.className = 'site8-image-viewer';
        imageViewer.innerHTML = `
            <div class="site8-image-viewer-controls">
                <i class="fa-solid fa-xmark close-viewer"></i>
                <i class="fa-solid fa-save save-image"></i>
            </div>
            <img src="${src}" alt="Full size image">
        `;
        document.body.appendChild(imageViewer);
        imageViewer.querySelector('.close-viewer').onclick = site8_closeImageViewer;
        imageViewer.querySelector('.save-image').onclick = () => {
            const imgToSave = imageViewer.querySelector('img');
            site8_downloadFile(imgToSave.src, `tauraronwasa-image-${Date.now()}.png`);
        };
        imageViewer.onclick = (e) => {
            if (e.target === imageViewer) {
                site8_closeImageViewer();
            }
        };
    } else {
        imageViewer.querySelector('img').src = src;
    }
    imageViewer.classList.add('active');
}

function site8_closeImageViewer() {
    if (imageViewer) {
        imageViewer.classList.remove('active');
    }
}

function site8_loadFromLocalStorage(key, cb, container) {
    try {
        const arr = JSON.parse(localStorage.getItem(key));
        if (arr && Array.isArray(arr)) {
            cb(arr);
        } else {
            container.innerHTML = "<div class='no-posts'>Babu wani rubutu a halin yanzu.</div>";
        }
    } catch (e) {
        console.error("Error loading from localStorage:", e);
        container.innerHTML = "<div class='no-posts'>Babu wani rubutu a halin yanzu.</div>";
    }
}

site8_loadFromLocalStorage(POSTING_KEY, site8_renderPostingFeed, site8);

onValue(postingRef, (snap) => {
    if (!snap.exists()) {
        site8.innerHTML = "<div class='no-posts'>Babu wani rubutu a halin yanzu.</div>";
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.startsWith('liked_') || key.startsWith('audio_current_time_') || key === POSTING_KEY || key === SEEN_POSTS_KEY) {
                localStorage.removeItem(key);
            }
        }
        return;
    }
    const firebasePosts = snap.val();
    const firebasePostIds = new Set(Object.keys(firebasePosts));
    const feedList = Object.values(firebasePosts).reverse().filter(post => {
        return post.postid && (post.text || post.photoLink1 || post.videoLink || post.audioLink);
    });
    feedList.forEach(post => {
        if (!post.totalComment) {
            post.totalComment = 0;
        }
    });
    site8_renderPostingFeed(feedList);
    localStorage.setItem(POSTING_KEY, JSON.stringify(feedList));
    let storedPosts = JSON.parse(localStorage.getItem(POSTING_KEY) || "[]");
    let updatedStoredPosts = storedPosts.filter(post => firebasePostIds.has(post.postid));
    localStorage.setItem(POSTING_KEY, JSON.stringify(updatedStoredPosts));
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if ((key.startsWith('liked_') || key.startsWith('audio_current_time_')) && !firebasePostIds.has(key.split('_')[1])) {
            localStorage.removeItem(key);
        }
    }
    let seenPostsData = site8_getSeenPosts();
    for (const postId in seenPostsData) {
        if (!firebasePostIds.has(postId)) {
            delete seenPostsData[postId];
        }
    }
    localStorage.setItem(SEEN_POSTS_KEY, JSON.stringify(seenPostsData));
});

// üö¶‚úîÔ∏èSite 8 JS ya kare daga nan





// Modern push1Alert() for TauraronWasa (Hausa)
function push1Alert(message, type = "info") {
  const alertBox = document.getElementById('push1-modern-alert');
  if (!alertBox) return;
  let icon = '<i class="fa-solid fa-circle-info icon"></i>';
  let bg = 'linear-gradient(90deg, #7d3cff 60%, #180022 120%)';
  if (type === "success") {
    icon = '<i class="fa-solid fa-circle-check icon"></i>';
    bg = 'linear-gradient(90deg, #2ecc71 60%, #180022 120%)';
  }
  if (type === "error") {
    icon = '<i class="fa-solid fa-circle-xmark icon"></i>';
    bg = 'linear-gradient(90deg, #ff4343 60%, #180022 120%)';
  }
  alertBox.innerHTML = icon + `<span>${message}</span>`;
  alertBox.style.background = bg;
  alertBox.classList.add('show');
  setTimeout(() => {
    alertBox.classList.remove('show');
  }, 3800);
}


// ======= INSTALL APP (PWA) =======
let installPromptEvent = null;
window.addEventListener('beforeinstallprompt', function(e) {
  e.preventDefault();
  installPromptEvent = e;
  document.getElementById('install-btn').style.display = 'inline-block';
});
document.getElementById('install-btn').addEventListener('click', function installSiteShowPrompt() {
  if (installPromptEvent) {
    installPromptEvent.prompt();
    installPromptEvent.userChoice.then(res => {
      if (res.outcome === 'accepted') {
        push1Alert('An saka TauraronWasa App cikin na\'urar ka!', 'success');
      }
    });
  }
});

// ======= PUSH NOTIF UI & LOGIC =======
const bellBtn = document.getElementById('push1-bell-btn');
const pushContainer = document.getElementById('push1-container');
const pushClose = document.getElementById('push1-close-btn');
const pushAllow = document.getElementById('push1-allow-btn');
const pushDeny = document.getElementById('push1-deny-btn');

// Show modal
bellBtn.addEventListener('click', function push1ShowContainer() {
  pushContainer.classList.add('show');
});

// Hide modal
pushClose.addEventListener('click', function push1HideContainer() {
  pushContainer.classList.remove('show');
});
pushDeny.addEventListener('click', function push1HideContainerDeny() {
  pushContainer.classList.remove('show');
});

// Register Service Worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js');
}

// PUSH NOTIFICATION SUBSCRIPTION
const applicationServerKey = 'BHKKgIF0DdjV9XXxXGI7MXQA_scnU0OxDP80OtZSlZyD02gSJY6aRYPxOS32bBP-wgjWAJr5VP4pDMYat38LGYc';

async function push1SubscribeUser() {
  if (!('serviceWorker' in navigator)) return;
  try {
    const registration = await navigator.serviceWorker.ready;
    const subscription = await registration.pushManager.subscribe({
      userVisibleOnly: true,
      applicationServerKey: urlB64ToUint8Array(applicationServerKey)
    });
    // Save subscription object to Firebase under user's UID
    if (window.currentUser && window.currentUser.uid) {
      await saveSubscriptionToFirebase(window.currentUser.uid, subscription);
    } else {
      // (Za a iya ajiye a localStorage ko a jira user ya shiga)
      localStorage.setItem('tw_sub', JSON.stringify(subscription));
    }
    pushContainer.classList.remove('show');
    push1Alert('An kunna sanarwa!', 'success');
  } catch (e) {
    push1Alert('Ba a samu damar kunnawa ba: ' + e, 'error');
  }
}
pushAllow.addEventListener('click', push1SubscribeUser);

// Helper: urlB64ToUint8Array for VAPID
function urlB64ToUint8Array(base64String) {
  const padding = '='.repeat((4 - base64String.length % 4) % 4);
  const base64 = (base64String + padding)
    .replace(/\-/g, '+')
    .replace(/_/g, '/');
  const rawData = window.atob(base64);
  const outputArray = new Uint8Array(rawData.length);
  for (let i = 0; i < rawData.length; ++i) {
    outputArray[i] = rawData.charCodeAt(i);
  }
  return outputArray;
}

// ====== SAVE SUBSCRIPTION TO FIREBASE ======
async function saveSubscriptionToFirebase(uid, subscription) {
 
  await set(ref(db, 'users/' + uid + '/subscription'), subscription);
}

// ========== USER AUTH STATE ==========
const auth = getAuth(app);
let currentUser = null;
onAuthStateChanged(auth, (user) => {
    currentUser = user;
    window.currentUser = user;
    if (user) {
        localStorage.setItem("tw_uid", user.uid);
        // Save subscription if exists in localStorage
        if (localStorage.getItem('tw_sub')) {
          const sub = JSON.parse(localStorage.getItem('tw_sub'));
          saveSubscriptionToFirebase(user.uid, sub);
          localStorage.removeItem('tw_sub');
        }
        document.getElementById('register-notification').classList.remove('show');
    } else {
        setTimeout(() => {
            if (!localStorage.getItem("tw_uid")) {
                document.getElementById('register-notification').classList.add('show');
            }
        }, 20000); 
    }
});

      </script>
      <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js').then(function(registration) {
                // An yi nasarar ha…óawa
                console.log('An yi nasarar ha…óa Service Worker da scope:', registration.scope);
            }, function(err) {
                // Akwai kuskure wajen ha…óawa
                console.log('Kuskuren ha…óa Service Worker:', err);
            });
        });
    }
</script>
</body>
</html>
